{"version":3,"sources":["canvas-tools.src.js"],"names":[],"mappings":"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","file":"canvas-tools.src-compiled.js","sourcesContent":["/**\n * @license A class to parse color values\n * @author Stoyan Stefanov <sstoo@gmail.com>\n * @link   http://www.phpied.com/rgb-color-parser-in-javascript/\n * Use it if you like it\n *\n */\nfunction RGBColor(color_string)\n{\n    this.ok = false;\n\n    // strip any leading #\n    if (color_string.charAt(0) == '#') { // remove # if any\n        color_string = color_string.substr(1,6);\n    }\n\n    color_string = color_string.replace(/ /g,'');\n    color_string = color_string.toLowerCase();\n\n    // before getting into regexps, try simple matches\n    // and overwrite the input\n    var simple_colors = {\n        aliceblue: 'f0f8ff',\n        antiquewhite: 'faebd7',\n        aqua: '00ffff',\n        aquamarine: '7fffd4',\n        azure: 'f0ffff',\n        beige: 'f5f5dc',\n        bisque: 'ffe4c4',\n        black: '000000',\n        blanchedalmond: 'ffebcd',\n        blue: '0000ff',\n        blueviolet: '8a2be2',\n        brown: 'a52a2a',\n        burlywood: 'deb887',\n        cadetblue: '5f9ea0',\n        chartreuse: '7fff00',\n        chocolate: 'd2691e',\n        coral: 'ff7f50',\n        cornflowerblue: '6495ed',\n        cornsilk: 'fff8dc',\n        crimson: 'dc143c',\n        cyan: '00ffff',\n        darkblue: '00008b',\n        darkcyan: '008b8b',\n        darkgoldenrod: 'b8860b',\n        darkgray: 'a9a9a9',\n        darkgreen: '006400',\n        darkkhaki: 'bdb76b',\n        darkmagenta: '8b008b',\n        darkolivegreen: '556b2f',\n        darkorange: 'ff8c00',\n        darkorchid: '9932cc',\n        darkred: '8b0000',\n        darksalmon: 'e9967a',\n        darkseagreen: '8fbc8f',\n        darkslateblue: '483d8b',\n        darkslategray: '2f4f4f',\n        darkturquoise: '00ced1',\n        darkviolet: '9400d3',\n        deeppink: 'ff1493',\n        deepskyblue: '00bfff',\n        dimgray: '696969',\n        dodgerblue: '1e90ff',\n        feldspar: 'd19275',\n        firebrick: 'b22222',\n        floralwhite: 'fffaf0',\n        forestgreen: '228b22',\n        fuchsia: 'ff00ff',\n        gainsboro: 'dcdcdc',\n        ghostwhite: 'f8f8ff',\n        gold: 'ffd700',\n        goldenrod: 'daa520',\n        gray: '808080',\n        green: '008000',\n        greenyellow: 'adff2f',\n        honeydew: 'f0fff0',\n        hotpink: 'ff69b4',\n        indianred : 'cd5c5c',\n        indigo : '4b0082',\n        ivory: 'fffff0',\n        khaki: 'f0e68c',\n        lavender: 'e6e6fa',\n        lavenderblush: 'fff0f5',\n        lawngreen: '7cfc00',\n        lemonchiffon: 'fffacd',\n        lightblue: 'add8e6',\n        lightcoral: 'f08080',\n        lightcyan: 'e0ffff',\n        lightgoldenrodyellow: 'fafad2',\n        lightgrey: 'd3d3d3',\n        lightgreen: '90ee90',\n        lightpink: 'ffb6c1',\n        lightsalmon: 'ffa07a',\n        lightseagreen: '20b2aa',\n        lightskyblue: '87cefa',\n        lightslateblue: '8470ff',\n        lightslategray: '778899',\n        lightsteelblue: 'b0c4de',\n        lightyellow: 'ffffe0',\n        lime: '00ff00',\n        limegreen: '32cd32',\n        linen: 'faf0e6',\n        magenta: 'ff00ff',\n        maroon: '800000',\n        mediumaquamarine: '66cdaa',\n        mediumblue: '0000cd',\n        mediumorchid: 'ba55d3',\n        mediumpurple: '9370d8',\n        mediumseagreen: '3cb371',\n        mediumslateblue: '7b68ee',\n        mediumspringgreen: '00fa9a',\n        mediumturquoise: '48d1cc',\n        mediumvioletred: 'c71585',\n        midnightblue: '191970',\n        mintcream: 'f5fffa',\n        mistyrose: 'ffe4e1',\n        moccasin: 'ffe4b5',\n        navajowhite: 'ffdead',\n        navy: '000080',\n        oldlace: 'fdf5e6',\n        olive: '808000',\n        olivedrab: '6b8e23',\n        orange: 'ffa500',\n        orangered: 'ff4500',\n        orchid: 'da70d6',\n        palegoldenrod: 'eee8aa',\n        palegreen: '98fb98',\n        paleturquoise: 'afeeee',\n        palevioletred: 'd87093',\n        papayawhip: 'ffefd5',\n        peachpuff: 'ffdab9',\n        peru: 'cd853f',\n        pink: 'ffc0cb',\n        plum: 'dda0dd',\n        powderblue: 'b0e0e6',\n        purple: '800080',\n        red: 'ff0000',\n        rosybrown: 'bc8f8f',\n        royalblue: '4169e1',\n        saddlebrown: '8b4513',\n        salmon: 'fa8072',\n        sandybrown: 'f4a460',\n        seagreen: '2e8b57',\n        seashell: 'fff5ee',\n        sienna: 'a0522d',\n        silver: 'c0c0c0',\n        skyblue: '87ceeb',\n        slateblue: '6a5acd',\n        slategray: '708090',\n        snow: 'fffafa',\n        springgreen: '00ff7f',\n        steelblue: '4682b4',\n        tan: 'd2b48c',\n        teal: '008080',\n        thistle: 'd8bfd8',\n        tomato: 'ff6347',\n        turquoise: '40e0d0',\n        violet: 'ee82ee',\n        violetred: 'd02090',\n        wheat: 'f5deb3',\n        white: 'ffffff',\n        whitesmoke: 'f5f5f5',\n        yellow: 'ffff00',\n        yellowgreen: '9acd32'\n    };\n    for (var key in simple_colors) {\n        if (color_string == key) {\n            color_string = simple_colors[key];\n        }\n    }\n    // emd of simple type-in colors\n\n    // array of color definition objects\n    var color_defs = [\n        {\n            re: /^rgb\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})\\)$/,\n            example: ['rgb(123, 234, 45)', 'rgb(255,234,245)'],\n            process: function (bits){\n                return [\n                    parseInt(bits[1]),\n                    parseInt(bits[2]),\n                    parseInt(bits[3])\n                ];\n            }\n        },\n        {\n            re: /^(\\w{2})(\\w{2})(\\w{2})$/,\n            example: ['#00ff00', '336699'],\n            process: function (bits){\n                return [\n                    parseInt(bits[1], 16),\n                    parseInt(bits[2], 16),\n                    parseInt(bits[3], 16)\n                ];\n            }\n        },\n        {\n            re: /^(\\w{1})(\\w{1})(\\w{1})$/,\n            example: ['#fb0', 'f0f'],\n            process: function (bits){\n                return [\n                    parseInt(bits[1] + bits[1], 16),\n                    parseInt(bits[2] + bits[2], 16),\n                    parseInt(bits[3] + bits[3], 16)\n                ];\n            }\n        }\n    ];\n\n    // search through the definitions to find a match\n    for (var i = 0; i < color_defs.length; i++) {\n        var re = color_defs[i].re;\n        var processor = color_defs[i].process;\n        var bits = re.exec(color_string);\n        if (bits) {\n            channels = processor(bits);\n            this.r = channels[0];\n            this.g = channels[1];\n            this.b = channels[2];\n            this.ok = true;\n        }\n\n    }\n\n    // validate/cleanup values\n    this.r = (this.r < 0 || isNaN(this.r)) ? 0 : ((this.r > 255) ? 255 : this.r);\n    this.g = (this.g < 0 || isNaN(this.g)) ? 0 : ((this.g > 255) ? 255 : this.g);\n    this.b = (this.b < 0 || isNaN(this.b)) ? 0 : ((this.b > 255) ? 255 : this.b);\n\n    // some getters\n    this.toRGB = function () {\n        return 'rgb(' + this.r + ', ' + this.g + ', ' + this.b + ')';\n    }\n    this.toHex = function () {\n        var r = this.r.toString(16);\n        var g = this.g.toString(16);\n        var b = this.b.toString(16);\n        if (r.length == 1) r = '0' + r;\n        if (g.length == 1) g = '0' + g;\n        if (b.length == 1) b = '0' + b;\n        return '#' + r + g + b;\n    }\n\n    // help\n    this.getHelpXML = function () {\n\n        var examples = new Array();\n        // add regexps\n        for (var i = 0; i < color_defs.length; i++) {\n            var example = color_defs[i].example;\n            for (var j = 0; j < example.length; j++) {\n                examples[examples.length] = example[j];\n            }\n        }\n        // add type-in colors\n        for (var sc in simple_colors) {\n            examples[examples.length] = sc;\n        }\n\n        var xml = document.createElement('ul');\n        xml.setAttribute('id', 'rgbcolor-examples');\n        for (var i = 0; i < examples.length; i++) {\n            try {\n                var list_item = document.createElement('li');\n                var list_color = new RGBColor(examples[i]);\n                var example_div = document.createElement('div');\n                example_div.style.cssText =\n                        'margin: 3px; '\n                        + 'border: 1px solid black; '\n                        + 'background:' + list_color.toHex() + '; '\n                        + 'color:' + list_color.toHex()\n                ;\n                example_div.appendChild(document.createTextNode('test'));\n                var list_item_value = document.createTextNode(\n                    ' ' + examples[i] + ' -> ' + list_color.toRGB() + ' -> ' + list_color.toHex()\n                );\n                list_item.appendChild(example_div);\n                list_item.appendChild(list_item_value);\n                xml.appendChild(list_item);\n\n            } catch(e){}\n        }\n        return xml;\n\n    }\n\n}\n\n/**\n * @license canvg.js - Javascript SVG parser and renderer on Canvas\n * MIT Licensed \n * Gabe Lerner (gabelerner@gmail.com)\n * http://code.google.com/p/canvg/\n *\n * Requires: rgbcolor.js - http://www.phpied.com/rgb-color-parser-in-javascript/\n *\n */\nif(!window.console) {\n\twindow.console = {};\n\twindow.console.log = function(str) {};\n\twindow.console.dir = function(str) {};\n}\n\nif(!Array.prototype.indexOf){\n\tArray.prototype.indexOf = function(obj){\n\t\tfor(var i=0; i<this.length; i++){\n\t\t\tif(this[i]==obj){\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n}\n\n(function(){\n\t// canvg(target, s)\n\t// empty parameters: replace all 'svg' elements on page with 'canvas' elements\n\t// target: canvas element or the id of a canvas element\n\t// s: svg string, url to svg file, or xml document\n\t// opts: optional hash of options\n\t//\t\t ignoreMouse: true => ignore mouse events\n\t//\t\t ignoreAnimation: true => ignore animations\n\t//\t\t ignoreDimensions: true => does not try to resize canvas\n\t//\t\t ignoreClear: true => does not clear canvas\n\t//\t\t offsetX: int => draws at a x offset\n\t//\t\t offsetY: int => draws at a y offset\n\t//\t\t scaleWidth: int => scales horizontally to width\n\t//\t\t scaleHeight: int => scales vertically to height\n\t//\t\t renderCallback: function => will call the function after the first render is completed\n\t//\t\t forceRedraw: function => will call the function on every frame, if it returns true, will redraw\n\tthis.canvg = function (target, s, opts) {\n\t\t// no parameters\n\t\tif (target == null && s == null && opts == null) {\n\t\t\tvar svgTags = document.getElementsByTagName('svg');\n\t\t\tfor (var i=0; i<svgTags.length; i++) {\n\t\t\t\tvar svgTag = svgTags[i];\n\t\t\t\tvar c = document.createElement('canvas');\n\t\t\t\tc.width = svgTag.clientWidth;\n\t\t\t\tc.height = svgTag.clientHeight;\n\t\t\t\tsvgTag.parentNode.insertBefore(c, svgTag);\n\t\t\t\tsvgTag.parentNode.removeChild(svgTag);\n\t\t\t\tvar div = document.createElement('div');\n\t\t\t\tdiv.appendChild(svgTag);\n\t\t\t\tcanvg(c, div.innerHTML);\n\t\t\t}\n\t\t\treturn;\n\t\t}\t\n\t\topts = opts || {};\n\t\n\t\tif (typeof target == 'string') {\n\t\t\ttarget = document.getElementById(target);\n\t\t}\n\t\t\n\t\t// reuse class per canvas\n\t\tvar svg;\n\t\tif (target.svg == null) {\n\t\t\tsvg = build();\n\t\t\ttarget.svg = svg;\n\t\t}\n\t\telse {\n\t\t\tsvg = target.svg;\n\t\t\tsvg.stop();\n\t\t}\n\t\tsvg.opts = opts;\n\t\t\n\t\tvar ctx = target.getContext('2d');\n\t\tif (typeof(s.documentElement) != 'undefined') {\n\t\t\t// load from xml doc\n\t\t\tsvg.loadXmlDoc(ctx, s);\n\t\t}\n\t\telse if (s.substr(0,1) == '<') {\n\t\t\t// load from xml string\n\t\t\tsvg.loadXml(ctx, s);\n\t\t}\n\t\telse {\n\t\t\t// load from url\n\t\t\tsvg.load(ctx, s);\n\t\t}\n\t}\n\n\tfunction build() {\n\t\tvar svg = { };\n\t\t\n\t\tsvg.FRAMERATE = 30;\n\t\tsvg.MAX_VIRTUAL_PIXELS = 30000;\n\t\t\n\t\t// globals\n\t\tsvg.init = function(ctx) {\n\t\t\tsvg.Definitions = {};\n\t\t\tsvg.Styles = {};\n\t\t\tsvg.Animations = [];\n\t\t\tsvg.Images = [];\n\t\t\tsvg.ctx = ctx;\n\t\t\tsvg.ViewPort = new (function () {\n\t\t\t\tthis.viewPorts = [];\n\t\t\t\tthis.Clear = function() { this.viewPorts = []; }\n\t\t\t\tthis.SetCurrent = function(width, height) { this.viewPorts.push({ width: width, height: height }); }\n\t\t\t\tthis.RemoveCurrent = function() { this.viewPorts.pop(); }\n\t\t\t\tthis.Current = function() { return this.viewPorts[this.viewPorts.length - 1]; }\n\t\t\t\tthis.width = function() { return this.Current().width; }\n\t\t\t\tthis.height = function() { return this.Current().height; }\n\t\t\t\tthis.ComputeSize = function(d) {\n\t\t\t\t\tif (d != null && typeof(d) == 'number') return d;\n\t\t\t\t\tif (d == 'x') return this.width();\n\t\t\t\t\tif (d == 'y') return this.height();\n\t\t\t\t\treturn Math.sqrt(Math.pow(this.width(), 2) + Math.pow(this.height(), 2)) / Math.sqrt(2);\t\t\t\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tsvg.init();\n\t\t\n\t\t// images loaded\n\t\tsvg.ImagesLoaded = function() { \n\t\t\tfor (var i=0; i<svg.Images.length; i++) {\n\t\t\t\tif (!svg.Images[i].loaded) return false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\t// trim\n\t\tsvg.trim = function(s) { return s.replace(/^\\s+|\\s+$/g, ''); }\n\t\t\n\t\t// compress spaces\n\t\tsvg.compressSpaces = function(s) { return s.replace(/[\\s\\r\\t\\n]+/gm,' '); }\n\t\t\n\t\t// ajax\n\t\tsvg.ajax = function(url) {\n\t\t\tvar AJAX;\n\t\t\tif(window.XMLHttpRequest){AJAX=new XMLHttpRequest();}\n\t\t\telse{AJAX=new ActiveXObject('Microsoft.XMLHTTP');}\n\t\t\tif(AJAX){\n\t\t\t   AJAX.open('GET',url,false);\n\t\t\t   AJAX.send(null);\n\t\t\t   return AJAX.responseText;\n\t\t\t}\n\t\t\treturn null;\n\t\t} \n\t\t\n\t\t// parse xml\n\t\tsvg.parseXml = function(xml) {\n\t\t\tif (window.DOMParser)\n\t\t\t{\n\t\t\t\tvar parser = new DOMParser();\n\t\t\t\treturn parser.parseFromString(xml, 'text/xml');\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\txml = xml.replace(/<!DOCTYPE svg[^>]*>/, '');\n\t\t\t\tvar xmlDoc = new ActiveXObject('Microsoft.XMLDOM');\n\t\t\t\txmlDoc.async = 'false';\n\t\t\t\txmlDoc.loadXML(xml); \n\t\t\t\treturn xmlDoc;\n\t\t\t}\t\t\n\t\t}\n\t\t\n\t\tsvg.Property = function(name, value) {\n\t\t\tthis.name = name;\n\t\t\tthis.value = value;\n\t\t\t\n\t\t\tthis.hasValue = function() {\n\t\t\t\treturn (this.value != null && this.value !== '');\n\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t// return the numerical value of the property\n\t\t\tthis.numValue = function() {\n\t\t\t\tif (!this.hasValue()) return 0;\n\t\t\t\t\n\t\t\t\tvar n = parseFloat(this.value);\n\t\t\t\tif ((this.value + '').match(/%$/)) {\n\t\t\t\t\tn = n / 100.0;\n\t\t\t\t}\n\t\t\t\treturn n;\n\t\t\t}\n\t\t\t\n\t\t\tthis.valueOrDefault = function(def) {\n\t\t\t\tif (this.hasValue()) return this.value;\n\t\t\t\treturn def;\n\t\t\t}\n\t\t\t\n\t\t\tthis.numValueOrDefault = function(def) {\n\t\t\t\tif (this.hasValue()) return this.numValue();\n\t\t\t\treturn def;\n\t\t\t}\n\t\t\t\n\t\t\t/* EXTENSIONS */\n\t\t\tvar that = this;\n\t\t\t\n\t\t\t// color extensions\n\t\t\tthis.Color = {\n\t\t\t\t// augment the current color value with the opacity\n\t\t\t\taddOpacity: function(opacity) {\n\t\t\t\t\tvar newValue = that.value;\n\t\t\t\t\tif (opacity != null && opacity != '') {\n\t\t\t\t\t\tvar color = new RGBColor(that.value);\n\t\t\t\t\t\tif (color.ok) {\n\t\t\t\t\t\t\tnewValue = 'rgba(' + color.r + ', ' + color.g + ', ' + color.b + ', ' + opacity + ')';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn new svg.Property(that.name, newValue);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// definition extensions\n\t\t\tthis.Definition = {\n\t\t\t\t// get the definition from the definitions table\n\t\t\t\tgetDefinition: function() {\n\t\t\t\t\tvar name = that.value.replace(/^(url\\()?#([^\\)]+)\\)?$/, '$2');\n\t\t\t\t\treturn svg.Definitions[name];\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tisUrl: function() {\n\t\t\t\t\treturn that.value.indexOf('url(') == 0\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tgetFillStyle: function(e) {\n\t\t\t\t\tvar def = this.getDefinition();\n\t\t\t\t\t\n\t\t\t\t\t// gradient\n\t\t\t\t\tif (def != null && def.createGradient) {\n\t\t\t\t\t\treturn def.createGradient(svg.ctx, e);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// pattern\n\t\t\t\t\tif (def != null && def.createPattern) {\n\t\t\t\t\t\treturn def.createPattern(svg.ctx, e);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// length extensions\n\t\t\tthis.Length = {\n\t\t\t\tDPI: function(viewPort) {\n\t\t\t\t\treturn 96.0; // TODO: compute?\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tEM: function(viewPort) {\n\t\t\t\t\tvar em = 12;\n\t\t\t\t\t\n\t\t\t\t\tvar fontSize = new svg.Property('fontSize', svg.Font.Parse(svg.ctx.font).fontSize);\n\t\t\t\t\tif (fontSize.hasValue()) em = fontSize.Length.toPixels(viewPort);\n\t\t\t\t\t\n\t\t\t\t\treturn em;\n\t\t\t\t},\n\t\t\t\n\t\t\t\t// get the length as pixels\n\t\t\t\ttoPixels: function(viewPort) {\n\t\t\t\t\tif (!that.hasValue()) return 0;\n\t\t\t\t\tvar s = that.value+'';\n\t\t\t\t\tif (s.match(/em$/)) return that.numValue() * this.EM(viewPort);\n\t\t\t\t\tif (s.match(/ex$/)) return that.numValue() * this.EM(viewPort) / 2.0;\n\t\t\t\t\tif (s.match(/px$/)) return that.numValue();\n\t\t\t\t\tif (s.match(/pt$/)) return that.numValue() * 1.25;\n\t\t\t\t\tif (s.match(/pc$/)) return that.numValue() * 15;\n\t\t\t\t\tif (s.match(/cm$/)) return that.numValue() * this.DPI(viewPort) / 2.54;\n\t\t\t\t\tif (s.match(/mm$/)) return that.numValue() * this.DPI(viewPort) / 25.4;\n\t\t\t\t\tif (s.match(/in$/)) return that.numValue() * this.DPI(viewPort);\n\t\t\t\t\tif (s.match(/%$/)) return that.numValue() * svg.ViewPort.ComputeSize(viewPort);\n\t\t\t\t\treturn that.numValue();\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// time extensions\n\t\t\tthis.Time = {\n\t\t\t\t// get the time as milliseconds\n\t\t\t\ttoMilliseconds: function() {\n\t\t\t\t\tif (!that.hasValue()) return 0;\n\t\t\t\t\tvar s = that.value+'';\n\t\t\t\t\tif (s.match(/s$/)) return that.numValue() * 1000;\n\t\t\t\t\tif (s.match(/ms$/)) return that.numValue();\n\t\t\t\t\treturn that.numValue();\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// angle extensions\n\t\t\tthis.Angle = {\n\t\t\t\t// get the angle as radians\n\t\t\t\ttoRadians: function() {\n\t\t\t\t\tif (!that.hasValue()) return 0;\n\t\t\t\t\tvar s = that.value+'';\n\t\t\t\t\tif (s.match(/deg$/)) return that.numValue() * (Math.PI / 180.0);\n\t\t\t\t\tif (s.match(/grad$/)) return that.numValue() * (Math.PI / 200.0);\n\t\t\t\t\tif (s.match(/rad$/)) return that.numValue();\n\t\t\t\t\treturn that.numValue() * (Math.PI / 180.0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t// fonts\n\t\tsvg.Font = new (function() {\n\t\t\tthis.Styles = ['normal','italic','oblique','inherit'];\n\t\t\tthis.Variants = ['normal','small-caps','inherit'];\n\t\t\tthis.Weights = ['normal','bold','bolder','lighter','100','200','300','400','500','600','700','800','900','inherit'];\n\t\t\t\n\t\t\tthis.CreateFont = function(fontStyle, fontVariant, fontWeight, fontSize, fontFamily, inherit) { \n\t\t\t\tvar f = inherit != null ? this.Parse(inherit) : this.CreateFont('', '', '', '', '', svg.ctx.font);\n\t\t\t\treturn { \n\t\t\t\t\tfontFamily: fontFamily || f.fontFamily, \n\t\t\t\t\tfontSize: fontSize || f.fontSize, \n\t\t\t\t\tfontStyle: fontStyle || f.fontStyle, \n\t\t\t\t\tfontWeight: fontWeight || f.fontWeight, \n\t\t\t\t\tfontVariant: fontVariant || f.fontVariant,\n\t\t\t\t\ttoString: function () { return [this.fontStyle, this.fontVariant, this.fontWeight, this.fontSize, this.fontFamily].join(' ') } \n\t\t\t\t} \n\t\t\t}\n\t\t\t\n\t\t\tvar that = this;\n\t\t\tthis.Parse = function(s) {\n\t\t\t\tvar f = {};\n\t\t\t\tvar d = svg.trim(svg.compressSpaces(s || '')).split(' ');\n\t\t\t\tvar set = { fontSize: false, fontStyle: false, fontWeight: false, fontVariant: false }\n\t\t\t\tvar ff = '';\n\t\t\t\tfor (var i=0; i<d.length; i++) {\n\t\t\t\t\tif (!set.fontStyle && that.Styles.indexOf(d[i]) != -1) { if (d[i] != 'inherit') f.fontStyle = d[i]; set.fontStyle = true; }\n\t\t\t\t\telse if (!set.fontVariant && that.Variants.indexOf(d[i]) != -1) { if (d[i] != 'inherit') f.fontVariant = d[i]; set.fontStyle = set.fontVariant = true;\t}\n\t\t\t\t\telse if (!set.fontWeight && that.Weights.indexOf(d[i]) != -1) {\tif (d[i] != 'inherit') f.fontWeight = d[i]; set.fontStyle = set.fontVariant = set.fontWeight = true; }\n\t\t\t\t\telse if (!set.fontSize) { if (d[i] != 'inherit') f.fontSize = d[i].split('/')[0]; set.fontStyle = set.fontVariant = set.fontWeight = set.fontSize = true; }\n\t\t\t\t\telse { if (d[i] != 'inherit') ff += d[i]; }\n\t\t\t\t} if (ff != '') f.fontFamily = ff;\n\t\t\t\treturn f;\n\t\t\t}\n\t\t});\n\t\t\n\t\t// points and paths\n\t\tsvg.ToNumberArray = function(s) {\n\t\t\tvar a = svg.trim(svg.compressSpaces((s || '').replace(/,/g, ' '))).split(' ');\n\t\t\tfor (var i=0; i<a.length; i++) {\n\t\t\t\ta[i] = parseFloat(a[i]);\n\t\t\t}\n\t\t\treturn a;\n\t\t}\t\t\n\t\tsvg.Point = function(x, y) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\t\n\t\t\tthis.angleTo = function(p) {\n\t\t\t\treturn Math.atan2(p.y - this.y, p.x - this.x);\n\t\t\t}\n\t\t\t\n\t\t\tthis.applyTransform = function(v) {\n\t\t\t\tvar xp = this.x * v[0] + this.y * v[2] + v[4];\n\t\t\t\tvar yp = this.x * v[1] + this.y * v[3] + v[5];\n\t\t\t\tthis.x = xp;\n\t\t\t\tthis.y = yp;\n\t\t\t}\n\t\t}\n\t\tsvg.CreatePoint = function(s) {\n\t\t\tvar a = svg.ToNumberArray(s);\n\t\t\treturn new svg.Point(a[0], a[1]);\n\t\t}\n\t\tsvg.CreatePath = function(s) {\n\t\t\tvar a = svg.ToNumberArray(s);\n\t\t\tvar path = [];\n\t\t\tfor (var i=0; i<a.length; i+=2) {\n\t\t\t\tpath.push(new svg.Point(a[i], a[i+1]));\n\t\t\t}\n\t\t\treturn path;\n\t\t}\n\t\t\n\t\t// bounding box\n\t\tsvg.BoundingBox = function(x1, y1, x2, y2) { // pass in initial points if you want\n\t\t\tthis.x1 = Number.NaN;\n\t\t\tthis.y1 = Number.NaN;\n\t\t\tthis.x2 = Number.NaN;\n\t\t\tthis.y2 = Number.NaN;\n\t\t\t\n\t\t\tthis.x = function() { return this.x1; }\n\t\t\tthis.y = function() { return this.y1; }\n\t\t\tthis.width = function() { return this.x2 - this.x1; }\n\t\t\tthis.height = function() { return this.y2 - this.y1; }\n\t\t\t\n\t\t\tthis.addPoint = function(x, y) {\t\n\t\t\t\tif (x != null) {\n\t\t\t\t\tif (isNaN(this.x1) || isNaN(this.x2)) {\n\t\t\t\t\t\tthis.x1 = x;\n\t\t\t\t\t\tthis.x2 = x;\n\t\t\t\t\t}\n\t\t\t\t\tif (x < this.x1) this.x1 = x;\n\t\t\t\t\tif (x > this.x2) this.x2 = x;\n\t\t\t\t}\n\t\t\t\n\t\t\t\tif (y != null) {\n\t\t\t\t\tif (isNaN(this.y1) || isNaN(this.y2)) {\n\t\t\t\t\t\tthis.y1 = y;\n\t\t\t\t\t\tthis.y2 = y;\n\t\t\t\t\t}\n\t\t\t\t\tif (y < this.y1) this.y1 = y;\n\t\t\t\t\tif (y > this.y2) this.y2 = y;\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t\tthis.addX = function(x) { this.addPoint(x, null); }\n\t\t\tthis.addY = function(y) { this.addPoint(null, y); }\n\t\t\t\n\t\t\tthis.addBoundingBox = function(bb) {\n\t\t\t\tthis.addPoint(bb.x1, bb.y1);\n\t\t\t\tthis.addPoint(bb.x2, bb.y2);\n\t\t\t}\n\t\t\t\n\t\t\tthis.addQuadraticCurve = function(p0x, p0y, p1x, p1y, p2x, p2y) {\n\t\t\t\tvar cp1x = p0x + 2/3 * (p1x - p0x); // CP1 = QP0 + 2/3 *(QP1-QP0)\n\t\t\t\tvar cp1y = p0y + 2/3 * (p1y - p0y); // CP1 = QP0 + 2/3 *(QP1-QP0)\n\t\t\t\tvar cp2x = cp1x + 1/3 * (p2x - p0x); // CP2 = CP1 + 1/3 *(QP2-QP0)\n\t\t\t\tvar cp2y = cp1y + 1/3 * (p2y - p0y); // CP2 = CP1 + 1/3 *(QP2-QP0)\n\t\t\t\tthis.addBezierCurve(p0x, p0y, cp1x, cp2x, cp1y,\tcp2y, p2x, p2y);\n\t\t\t}\n\t\t\t\n\t\t\tthis.addBezierCurve = function(p0x, p0y, p1x, p1y, p2x, p2y, p3x, p3y) {\n\t\t\t\t// from http://blog.hackers-cafe.net/2009/06/how-to-calculate-bezier-curves-bounding.html\n\t\t\t\tvar p0 = [p0x, p0y], p1 = [p1x, p1y], p2 = [p2x, p2y], p3 = [p3x, p3y];\n\t\t\t\tthis.addPoint(p0[0], p0[1]);\n\t\t\t\tthis.addPoint(p3[0], p3[1]);\n\t\t\t\t\n\t\t\t\tfor (i=0; i<=1; i++) {\n\t\t\t\t\tvar f = function(t) { \n\t\t\t\t\t\treturn Math.pow(1-t, 3) * p0[i]\n\t\t\t\t\t\t+ 3 * Math.pow(1-t, 2) * t * p1[i]\n\t\t\t\t\t\t+ 3 * (1-t) * Math.pow(t, 2) * p2[i]\n\t\t\t\t\t\t+ Math.pow(t, 3) * p3[i];\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar b = 6 * p0[i] - 12 * p1[i] + 6 * p2[i];\n\t\t\t\t\tvar a = -3 * p0[i] + 9 * p1[i] - 9 * p2[i] + 3 * p3[i];\n\t\t\t\t\tvar c = 3 * p1[i] - 3 * p0[i];\n\t\t\t\t\t\n\t\t\t\t\tif (a == 0) {\n\t\t\t\t\t\tif (b == 0) continue;\n\t\t\t\t\t\tvar t = -c / b;\n\t\t\t\t\t\tif (0 < t && t < 1) {\n\t\t\t\t\t\t\tif (i == 0) this.addX(f(t));\n\t\t\t\t\t\t\tif (i == 1) this.addY(f(t));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar b2ac = Math.pow(b, 2) - 4 * c * a;\n\t\t\t\t\tif (b2ac < 0) continue;\n\t\t\t\t\tvar t1 = (-b + Math.sqrt(b2ac)) / (2 * a);\n\t\t\t\t\tif (0 < t1 && t1 < 1) {\n\t\t\t\t\t\tif (i == 0) this.addX(f(t1));\n\t\t\t\t\t\tif (i == 1) this.addY(f(t1));\n\t\t\t\t\t}\n\t\t\t\t\tvar t2 = (-b - Math.sqrt(b2ac)) / (2 * a);\n\t\t\t\t\tif (0 < t2 && t2 < 1) {\n\t\t\t\t\t\tif (i == 0) this.addX(f(t2));\n\t\t\t\t\t\tif (i == 1) this.addY(f(t2));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.isPointInBox = function(x, y) {\n\t\t\t\treturn (this.x1 <= x && x <= this.x2 && this.y1 <= y && y <= this.y2);\n\t\t\t}\n\t\t\t\n\t\t\tthis.addPoint(x1, y1);\n\t\t\tthis.addPoint(x2, y2);\n\t\t}\n\t\t\n\t\t// transforms\n\t\tsvg.Transform = function(v) {\t\n\t\t\tvar that = this;\n\t\t\tthis.Type = {}\n\t\t\n\t\t\t// translate\n\t\t\tthis.Type.translate = function(s) {\n\t\t\t\tthis.p = svg.CreatePoint(s);\t\t\t\n\t\t\t\tthis.apply = function(ctx) {\n\t\t\t\t\tctx.translate(this.p.x || 0.0, this.p.y || 0.0);\n\t\t\t\t}\n\t\t\t\tthis.applyToPoint = function(p) {\n\t\t\t\t\tp.applyTransform([1, 0, 0, 1, this.p.x || 0.0, this.p.y || 0.0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// rotate\n\t\t\tthis.Type.rotate = function(s) {\n\t\t\t\tvar a = svg.ToNumberArray(s);\n\t\t\t\tthis.angle = new svg.Property('angle', a[0]);\n\t\t\t\tthis.cx = a[1] || 0;\n\t\t\t\tthis.cy = a[2] || 0;\n\t\t\t\tthis.apply = function(ctx) {\n\t\t\t\t\tctx.translate(this.cx, this.cy);\n\t\t\t\t\tctx.rotate(this.angle.Angle.toRadians());\n\t\t\t\t\tctx.translate(-this.cx, -this.cy);\n\t\t\t\t}\n\t\t\t\tthis.applyToPoint = function(p) {\n\t\t\t\t\tvar a = this.angle.Angle.toRadians();\n\t\t\t\t\tp.applyTransform([1, 0, 0, 1, this.p.x || 0.0, this.p.y || 0.0]);\n\t\t\t\t\tp.applyTransform([Math.cos(a), Math.sin(a), -Math.sin(a), Math.cos(a), 0, 0]);\n\t\t\t\t\tp.applyTransform([1, 0, 0, 1, -this.p.x || 0.0, -this.p.y || 0.0]);\n\t\t\t\t}\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tthis.Type.scale = function(s) {\n\t\t\t\tthis.p = svg.CreatePoint(s);\n\t\t\t\tthis.apply = function(ctx) {\n\t\t\t\t\tctx.scale(this.p.x || 1.0, this.p.y || this.p.x || 1.0);\n\t\t\t\t}\n\t\t\t\tthis.applyToPoint = function(p) {\n\t\t\t\t\tp.applyTransform([this.p.x || 0.0, 0, 0, this.p.y || 0.0, 0, 0]);\n\t\t\t\t}\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tthis.Type.matrix = function(s) {\n\t\t\t\tthis.m = svg.ToNumberArray(s);\n\t\t\t\tthis.apply = function(ctx) {\n\t\t\t\t\tctx.transform(this.m[0], this.m[1], this.m[2], this.m[3], this.m[4], this.m[5]);\n\t\t\t\t}\n\t\t\t\tthis.applyToPoint = function(p) {\n\t\t\t\t\tp.applyTransform(this.m);\n\t\t\t\t}\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tthis.Type.SkewBase = function(s) {\n\t\t\t\tthis.base = that.Type.matrix;\n\t\t\t\tthis.base(s);\n\t\t\t\tthis.angle = new svg.Property('angle', s);\n\t\t\t}\n\t\t\tthis.Type.SkewBase.prototype = new this.Type.matrix;\n\t\t\t\n\t\t\tthis.Type.skewX = function(s) {\n\t\t\t\tthis.base = that.Type.SkewBase;\n\t\t\t\tthis.base(s);\n\t\t\t\tthis.m = [1, 0, Math.tan(this.angle.Angle.toRadians()), 1, 0, 0];\n\t\t\t}\n\t\t\tthis.Type.skewX.prototype = new this.Type.SkewBase;\n\t\t\t\n\t\t\tthis.Type.skewY = function(s) {\n\t\t\t\tthis.base = that.Type.SkewBase;\n\t\t\t\tthis.base(s);\n\t\t\t\tthis.m = [1, Math.tan(this.angle.Angle.toRadians()), 0, 1, 0, 0];\n\t\t\t}\n\t\t\tthis.Type.skewY.prototype = new this.Type.SkewBase;\n\t\t\n\t\t\tthis.transforms = [];\n\t\t\t\n\t\t\tthis.apply = function(ctx) {\n\t\t\t\tfor (var i=0; i<this.transforms.length; i++) {\n\t\t\t\t\tthis.transforms[i].apply(ctx);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.applyToPoint = function(p) {\n\t\t\t\tfor (var i=0; i<this.transforms.length; i++) {\n\t\t\t\t\tthis.transforms[i].applyToPoint(p);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tvar data = svg.trim(svg.compressSpaces(v)).split(/\\s(?=[a-z])/);\n\t\t\tfor (var i=0; i<data.length; i++) {\n\t\t\t\tvar type = data[i].split('(')[0];\n\t\t\t\tvar s = data[i].split('(')[1].replace(')','');\n\t\t\t\tvar transform = new this.Type[type](s);\n\t\t\t\tthis.transforms.push(transform);\n\t\t\t}\n\t\t}\n\t\t\n\t\t// aspect ratio\n\t\tsvg.AspectRatio = function(ctx, aspectRatio, width, desiredWidth, height, desiredHeight, minX, minY, refX, refY) {\n\t\t\t// aspect ratio - http://www.w3.org/TR/SVG/coords.html#PreserveAspectRatioAttribute\n\t\t\taspectRatio = svg.compressSpaces(aspectRatio);\n\t\t\taspectRatio = aspectRatio.replace(/^defer\\s/,''); // ignore defer\n\t\t\tvar align = aspectRatio.split(' ')[0] || 'xMidYMid';\n\t\t\tvar meetOrSlice = aspectRatio.split(' ')[1] || 'meet';\t\t\t\t\t\n\t\n\t\t\t// calculate scale\n\t\t\tvar scaleX = width / desiredWidth;\n\t\t\tvar scaleY = height / desiredHeight;\n\t\t\tvar scaleMin = Math.min(scaleX, scaleY);\n\t\t\tvar scaleMax = Math.max(scaleX, scaleY);\n\t\t\tif (meetOrSlice == 'meet') { desiredWidth *= scaleMin; desiredHeight *= scaleMin; }\n\t\t\tif (meetOrSlice == 'slice') { desiredWidth *= scaleMax; desiredHeight *= scaleMax; }\t\n\t\t\t\n\t\t\trefX = new svg.Property('refX', refX);\n\t\t\trefY = new svg.Property('refY', refY);\n\t\t\tif (refX.hasValue() && refY.hasValue()) {\t\t\t\t\n\t\t\t\tctx.translate(-scaleMin * refX.Length.toPixels('x'), -scaleMin * refY.Length.toPixels('y'));\n\t\t\t} \n\t\t\telse {\t\t\t\t\t\n\t\t\t\t// align\n\t\t\t\tif (align.match(/^xMid/) && ((meetOrSlice == 'meet' && scaleMin == scaleY) || (meetOrSlice == 'slice' && scaleMax == scaleY))) ctx.translate(width / 2.0 - desiredWidth / 2.0, 0); \n\t\t\t\tif (align.match(/YMid$/) && ((meetOrSlice == 'meet' && scaleMin == scaleX) || (meetOrSlice == 'slice' && scaleMax == scaleX))) ctx.translate(0, height / 2.0 - desiredHeight / 2.0); \n\t\t\t\tif (align.match(/^xMax/) && ((meetOrSlice == 'meet' && scaleMin == scaleY) || (meetOrSlice == 'slice' && scaleMax == scaleY))) ctx.translate(width - desiredWidth, 0); \n\t\t\t\tif (align.match(/YMax$/) && ((meetOrSlice == 'meet' && scaleMin == scaleX) || (meetOrSlice == 'slice' && scaleMax == scaleX))) ctx.translate(0, height - desiredHeight); \n\t\t\t}\n\t\t\t\n\t\t\t// scale\n\t\t\tif (align == 'none') ctx.scale(scaleX, scaleY);\n\t\t\telse if (meetOrSlice == 'meet') ctx.scale(scaleMin, scaleMin); \n\t\t\telse if (meetOrSlice == 'slice') ctx.scale(scaleMax, scaleMax); \t\n\t\t\t\n\t\t\t// translate\n\t\t\tctx.translate(minX == null ? 0 : -minX, minY == null ? 0 : -minY);\t\t\t\n\t\t}\n\t\t\n\t\t// elements\n\t\tsvg.Element = {}\n\t\t\n\t\tsvg.Element.ElementBase = function(node) {\t\n\t\t\tthis.attributes = {};\n\t\t\tthis.styles = {};\n\t\t\tthis.children = [];\n\t\t\t\n\t\t\t// get or create attribute\n\t\t\tthis.attribute = function(name, createIfNotExists) {\n\t\t\t\tvar a = this.attributes[name];\n\t\t\t\tif (a != null) return a;\n\t\t\t\t\t\t\t\n\t\t\t\ta = new svg.Property(name, '');\n\t\t\t\tif (createIfNotExists == true) this.attributes[name] = a;\n\t\t\t\treturn a;\n\t\t\t}\n\t\t\t\n\t\t\t// get or create style, crawls up node tree\n\t\t\tthis.style = function(name, createIfNotExists) {\n\t\t\t\tvar s = this.styles[name];\n\t\t\t\tif (s != null) return s;\n\t\t\t\t\n\t\t\t\tvar a = this.attribute(name);\n\t\t\t\tif (a != null && a.hasValue()) {\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar p = this.parent;\n\t\t\t\tif (p != null) {\n\t\t\t\t\tvar ps = p.style(name);\n\t\t\t\t\tif (ps != null && ps.hasValue()) {\n\t\t\t\t\t\treturn ps;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\ts = new svg.Property(name, '');\n\t\t\t\tif (createIfNotExists == true) this.styles[name] = s;\n\t\t\t\treturn s;\n\t\t\t}\n\t\t\t\n\t\t\t// base render\n\t\t\tthis.render = function(ctx) {\n\t\t\t\t// don't render display=none\n\t\t\t\tif (this.style('display').value == 'none') return;\n\t\t\t\t\n\t\t\t\t// don't render visibility=hidden\n\t\t\t\tif (this.attribute('visibility').value == 'hidden') return;\n\t\t\t\n\t\t\t\tctx.save();\n\t\t\t\t\tthis.setContext(ctx);\n\t\t\t\t\t\t// mask\n\t\t\t\t\t\tif (this.attribute('mask').hasValue()) {\n\t\t\t\t\t\t\tvar mask = this.attribute('mask').Definition.getDefinition();\n\t\t\t\t\t\t\tif (mask != null) mask.apply(ctx, this);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (this.style('filter').hasValue()) {\n\t\t\t\t\t\t\tvar filter = this.style('filter').Definition.getDefinition();\n\t\t\t\t\t\t\tif (filter != null) filter.apply(ctx, this);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse this.renderChildren(ctx);\t\t\t\t\n\t\t\t\t\tthis.clearContext(ctx);\n\t\t\t\tctx.restore();\n\t\t\t}\n\t\t\t\n\t\t\t// base set context\n\t\t\tthis.setContext = function(ctx) {\n\t\t\t\t// OVERRIDE ME!\n\t\t\t}\n\t\t\t\n\t\t\t// base clear context\n\t\t\tthis.clearContext = function(ctx) {\n\t\t\t\t// OVERRIDE ME!\n\t\t\t}\t\t\t\n\t\t\t\n\t\t\t// base render children\n\t\t\tthis.renderChildren = function(ctx) {\n\t\t\t\tfor (var i=0; i<this.children.length; i++) {\n\t\t\t\t\tthis.children[i].render(ctx);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.addChild = function(childNode, create) {\n\t\t\t\tvar child = childNode;\n\t\t\t\tif (create) child = svg.CreateElement(childNode);\n\t\t\t\tchild.parent = this;\n\t\t\t\tthis.children.push(child);\t\t\t\n\t\t\t}\n\t\t\t\t\n\t\t\tif (node != null && node.nodeType == 1) { //ELEMENT_NODE\n\t\t\t\t// add children\n\t\t\t\tfor (var i=0; i<node.childNodes.length; i++) {\n\t\t\t\t\tvar childNode = node.childNodes[i];\n\t\t\t\t\tif (childNode.nodeType == 1) this.addChild(childNode, true); //ELEMENT_NODE\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// add attributes\n\t\t\t\tfor (var i=0; i<node.attributes.length; i++) {\n\t\t\t\t\tvar attribute = node.attributes[i];\n\t\t\t\t\tthis.attributes[attribute.nodeName] = new svg.Property(attribute.nodeName, attribute.nodeValue);\n\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t// add tag styles\n\t\t\t\tvar styles = svg.Styles[node.nodeName];\n\t\t\t\tif (styles != null) {\n\t\t\t\t\tfor (var name in styles) {\n\t\t\t\t\t\tthis.styles[name] = styles[name];\n\t\t\t\t\t}\n\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t// add class styles\n\t\t\t\tif (this.attribute('class').hasValue()) {\n\t\t\t\t\tvar classes = svg.compressSpaces(this.attribute('class').value).split(' ');\n\t\t\t\t\tfor (var j=0; j<classes.length; j++) {\n\t\t\t\t\t\tstyles = svg.Styles['.'+classes[j]];\n\t\t\t\t\t\tif (styles != null) {\n\t\t\t\t\t\t\tfor (var name in styles) {\n\t\t\t\t\t\t\t\tthis.styles[name] = styles[name];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstyles = svg.Styles[node.nodeName+'.'+classes[j]];\n\t\t\t\t\t\tif (styles != null) {\n\t\t\t\t\t\t\tfor (var name in styles) {\n\t\t\t\t\t\t\t\tthis.styles[name] = styles[name];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// add inline styles\n\t\t\t\tif (this.attribute('style').hasValue()) {\n\t\t\t\t\tvar styles = this.attribute('style').value.split(';');\n\t\t\t\t\tfor (var i=0; i<styles.length; i++) {\n\t\t\t\t\t\tif (svg.trim(styles[i]) != '') {\n\t\t\t\t\t\t\tvar style = styles[i].split(':');\n\t\t\t\t\t\t\tvar name = svg.trim(style[0]);\n\t\t\t\t\t\t\tvar value = svg.trim(style[1]);\n\t\t\t\t\t\t\tthis.styles[name] = new svg.Property(name, value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\t\n\n\t\t\t\t// add id\n\t\t\t\tif (this.attribute('id').hasValue()) {\n\t\t\t\t\tif (svg.Definitions[this.attribute('id').value] == null) {\n\t\t\t\t\t\tsvg.Definitions[this.attribute('id').value] = this;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tsvg.Element.RenderedElementBase = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.setContext = function(ctx) {\n\t\t\t\t// fill\n\t\t\t\tif (this.style('fill').Definition.isUrl()) {\n\t\t\t\t\tvar fs = this.style('fill').Definition.getFillStyle(this);\n\t\t\t\t\tif (fs != null) ctx.fillStyle = fs;\n\t\t\t\t}\n\t\t\t\telse if (this.style('fill').hasValue()) {\n\t\t\t\t\tvar fillStyle = this.style('fill');\n\t\t\t\t\tif (this.style('fill-opacity').hasValue()) fillStyle = fillStyle.Color.addOpacity(this.style('fill-opacity').value);\n\t\t\t\t\tctx.fillStyle = (fillStyle.value == 'none' ? 'rgba(0,0,0,0)' : fillStyle.value);\n\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t// stroke\n\t\t\t\tif (this.style('stroke').Definition.isUrl()) {\n\t\t\t\t\tvar fs = this.style('stroke').Definition.getFillStyle(this);\n\t\t\t\t\tif (fs != null) ctx.strokeStyle = fs;\n\t\t\t\t}\n\t\t\t\telse if (this.style('stroke').hasValue()) {\n\t\t\t\t\tvar strokeStyle = this.style('stroke');\n\t\t\t\t\tif (this.style('stroke-opacity').hasValue()) strokeStyle = strokeStyle.Color.addOpacity(this.style('stroke-opacity').value);\n\t\t\t\t\tctx.strokeStyle = (strokeStyle.value == 'none' ? 'rgba(0,0,0,0)' : strokeStyle.value);\n\t\t\t\t}\n\t\t\t\tif (this.style('stroke-width').hasValue()) ctx.lineWidth = this.style('stroke-width').Length.toPixels();\n\t\t\t\tif (this.style('stroke-linecap').hasValue()) ctx.lineCap = this.style('stroke-linecap').value;\n\t\t\t\tif (this.style('stroke-linejoin').hasValue()) ctx.lineJoin = this.style('stroke-linejoin').value;\n\t\t\t\tif (this.style('stroke-miterlimit').hasValue()) ctx.miterLimit = this.style('stroke-miterlimit').value;\n\n\t\t\t\t// font\n\t\t\t\tif (typeof(ctx.font) != 'undefined') {\n\t\t\t\t\tctx.font = svg.Font.CreateFont( \n\t\t\t\t\t\tthis.style('font-style').value, \n\t\t\t\t\t\tthis.style('font-variant').value, \n\t\t\t\t\t\tthis.style('font-weight').value, \n\t\t\t\t\t\tthis.style('font-size').hasValue() ? this.style('font-size').Length.toPixels() + 'px' : '', \n\t\t\t\t\t\tthis.style('font-family').value).toString();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// transform\n\t\t\t\tif (this.attribute('transform').hasValue()) { \n\t\t\t\t\tvar transform = new svg.Transform(this.attribute('transform').value);\n\t\t\t\t\ttransform.apply(ctx);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// clip\n\t\t\t\tif (this.attribute('clip-path').hasValue()) {\n\t\t\t\t\tvar clip = this.attribute('clip-path').Definition.getDefinition();\n\t\t\t\t\tif (clip != null) clip.apply(ctx);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// opacity\n\t\t\t\tif (this.style('opacity').hasValue()) {\n\t\t\t\t\tctx.globalAlpha = this.style('opacity').numValue();\n\t\t\t\t}\n\t\t\t}\t\t\n\t\t}\n\t\tsvg.Element.RenderedElementBase.prototype = new svg.Element.ElementBase;\n\t\t\n\t\tsvg.Element.PathElementBase = function(node) {\n\t\t\tthis.base = svg.Element.RenderedElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.path = function(ctx) {\n\t\t\t\tif (ctx != null) ctx.beginPath();\n\t\t\t\treturn new svg.BoundingBox();\n\t\t\t}\n\t\t\t\n\t\t\tthis.renderChildren = function(ctx) {\n\t\t\t\tthis.path(ctx);\n\t\t\t\tsvg.Mouse.checkPath(this, ctx);\n\t\t\t\tif (ctx.fillStyle != '') ctx.fill();\n\t\t\t\tif (ctx.strokeStyle != '') ctx.stroke();\n\t\t\t\t\n\t\t\t\tvar markers = this.getMarkers();\n\t\t\t\tif (markers != null) {\n\t\t\t\t\tif (this.style('marker-start').Definition.isUrl()) {\n\t\t\t\t\t\tvar marker = this.style('marker-start').Definition.getDefinition();\n\t\t\t\t\t\tmarker.render(ctx, markers[0][0], markers[0][1]);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.style('marker-mid').Definition.isUrl()) {\n\t\t\t\t\t\tvar marker = this.style('marker-mid').Definition.getDefinition();\n\t\t\t\t\t\tfor (var i=1;i<markers.length-1;i++) {\n\t\t\t\t\t\t\tmarker.render(ctx, markers[i][0], markers[i][1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (this.style('marker-end').Definition.isUrl()) {\n\t\t\t\t\t\tvar marker = this.style('marker-end').Definition.getDefinition();\n\t\t\t\t\t\tmarker.render(ctx, markers[markers.length-1][0], markers[markers.length-1][1]);\n\t\t\t\t\t}\n\t\t\t\t}\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tthis.getBoundingBox = function() {\n\t\t\t\treturn this.path();\n\t\t\t}\n\t\t\t\n\t\t\tthis.getMarkers = function() {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\tsvg.Element.PathElementBase.prototype = new svg.Element.RenderedElementBase;\n\t\t\n\t\t// svg element\n\t\tsvg.Element.svg = function(node) {\n\t\t\tthis.base = svg.Element.RenderedElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.baseClearContext = this.clearContext;\n\t\t\tthis.clearContext = function(ctx) {\n\t\t\t\tthis.baseClearContext(ctx);\n\t\t\t\tsvg.ViewPort.RemoveCurrent();\n\t\t\t}\n\t\t\t\n\t\t\tthis.baseSetContext = this.setContext;\n\t\t\tthis.setContext = function(ctx) {\n\t\t\t\t// initial values\n\t\t\t\tctx.strokeStyle = 'rgba(0,0,0,0)';\n\t\t\t\tctx.lineCap = 'butt';\n\t\t\t\tctx.lineJoin = 'miter';\n\t\t\t\tctx.miterLimit = 4;\t\t\t\n\t\t\t\n\t\t\t\tthis.baseSetContext(ctx);\n\t\t\t\t\n\t\t\t\t// create new view port\n\t\t\t\tif (this.attribute('x').hasValue() && this.attribute('y').hasValue()) {\n\t\t\t\t\tctx.translate(this.attribute('x').Length.toPixels('x'), this.attribute('y').Length.toPixels('y'));\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar width = svg.ViewPort.width();\n\t\t\t\tvar height = svg.ViewPort.height();\n\t\t\t\tif (typeof(this.root) == 'undefined' && this.attribute('width').hasValue() && this.attribute('height').hasValue()) {\n\t\t\t\t\twidth = this.attribute('width').Length.toPixels('x');\n\t\t\t\t\theight = this.attribute('height').Length.toPixels('y');\n\t\t\t\t\t\n\t\t\t\t\tvar x = 0;\n\t\t\t\t\tvar y = 0;\n\t\t\t\t\tif (this.attribute('refX').hasValue() && this.attribute('refY').hasValue()) {\n\t\t\t\t\t\tx = -this.attribute('refX').Length.toPixels('x');\n\t\t\t\t\t\ty = -this.attribute('refY').Length.toPixels('y');\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(x, y);\n\t\t\t\t\tctx.lineTo(width, y);\n\t\t\t\t\tctx.lineTo(width, height);\n\t\t\t\t\tctx.lineTo(x, height);\n\t\t\t\t\tctx.closePath();\n\t\t\t\t\tctx.clip();\n\t\t\t\t}\n\t\t\t\tsvg.ViewPort.SetCurrent(width, height);\t\n\t\t\t\t\t\t\n\t\t\t\t// viewbox\n\t\t\t\tif (this.attribute('viewBox').hasValue()) {\t\t\t\t\n\t\t\t\t\tvar viewBox = svg.ToNumberArray(this.attribute('viewBox').value);\n\t\t\t\t\tvar minX = viewBox[0];\n\t\t\t\t\tvar minY = viewBox[1];\n\t\t\t\t\twidth = viewBox[2];\n\t\t\t\t\theight = viewBox[3];\n\t\t\t\t\t\n\t\t\t\t\tsvg.AspectRatio(ctx,\n\t\t\t\t\t\t\t\t\tthis.attribute('preserveAspectRatio').value, \n\t\t\t\t\t\t\t\t\tsvg.ViewPort.width(), \n\t\t\t\t\t\t\t\t\twidth,\n\t\t\t\t\t\t\t\t\tsvg.ViewPort.height(),\n\t\t\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t\t\t\tminX,\n\t\t\t\t\t\t\t\t\tminY,\n\t\t\t\t\t\t\t\t\tthis.attribute('refX').value,\n\t\t\t\t\t\t\t\t\tthis.attribute('refY').value);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tsvg.ViewPort.RemoveCurrent();\t\n\t\t\t\t\tsvg.ViewPort.SetCurrent(viewBox[2], viewBox[3]);\t\t\t\t\t\t\n\t\t\t\t}\t\t\t\t\n\t\t\t}\n\t\t}\n\t\tsvg.Element.svg.prototype = new svg.Element.RenderedElementBase;\n\n\t\t// rect element\n\t\tsvg.Element.rect = function(node) {\n\t\t\tthis.base = svg.Element.PathElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.path = function(ctx) {\n\t\t\t\tvar x = this.attribute('x').Length.toPixels('x');\n\t\t\t\tvar y = this.attribute('y').Length.toPixels('y');\n\t\t\t\tvar width = this.attribute('width').Length.toPixels('x');\n\t\t\t\tvar height = this.attribute('height').Length.toPixels('y');\n\t\t\t\tvar rx = this.attribute('rx').Length.toPixels('x');\n\t\t\t\tvar ry = this.attribute('ry').Length.toPixels('y');\n\t\t\t\tif (this.attribute('rx').hasValue() && !this.attribute('ry').hasValue()) ry = rx;\n\t\t\t\tif (this.attribute('ry').hasValue() && !this.attribute('rx').hasValue()) rx = ry;\n\t\t\t\t\n\t\t\t\tif (ctx != null) {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(x + rx, y);\n\t\t\t\t\tctx.lineTo(x + width - rx, y);\n\t\t\t\t\tctx.quadraticCurveTo(x + width, y, x + width, y + ry)\n\t\t\t\t\tctx.lineTo(x + width, y + height - ry);\n\t\t\t\t\tctx.quadraticCurveTo(x + width, y + height, x + width - rx, y + height)\n\t\t\t\t\tctx.lineTo(x + rx, y + height);\n\t\t\t\t\tctx.quadraticCurveTo(x, y + height, x, y + height - ry)\n\t\t\t\t\tctx.lineTo(x, y + ry);\n\t\t\t\t\tctx.quadraticCurveTo(x, y, x + rx, y)\n\t\t\t\t\tctx.closePath();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn new svg.BoundingBox(x, y, x + width, y + height);\n\t\t\t}\n\t\t}\n\t\tsvg.Element.rect.prototype = new svg.Element.PathElementBase;\n\t\t\n\t\t// circle element\n\t\tsvg.Element.circle = function(node) {\n\t\t\tthis.base = svg.Element.PathElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.path = function(ctx) {\n\t\t\t\tvar cx = this.attribute('cx').Length.toPixels('x');\n\t\t\t\tvar cy = this.attribute('cy').Length.toPixels('y');\n\t\t\t\tvar r = this.attribute('r').Length.toPixels();\n\t\t\t\n\t\t\t\tif (ctx != null) {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.arc(cx, cy, r, 0, Math.PI * 2, true); \n\t\t\t\t\tctx.closePath();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn new svg.BoundingBox(cx - r, cy - r, cx + r, cy + r);\n\t\t\t}\n\t\t}\n\t\tsvg.Element.circle.prototype = new svg.Element.PathElementBase;\t\n\n\t\t// ellipse element\n\t\tsvg.Element.ellipse = function(node) {\n\t\t\tthis.base = svg.Element.PathElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.path = function(ctx) {\n\t\t\t\tvar KAPPA = 4 * ((Math.sqrt(2) - 1) / 3);\n\t\t\t\tvar rx = this.attribute('rx').Length.toPixels('x');\n\t\t\t\tvar ry = this.attribute('ry').Length.toPixels('y');\n\t\t\t\tvar cx = this.attribute('cx').Length.toPixels('x');\n\t\t\t\tvar cy = this.attribute('cy').Length.toPixels('y');\n\t\t\t\t\n\t\t\t\tif (ctx != null) {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(cx, cy - ry);\n\t\t\t\t\tctx.bezierCurveTo(cx + (KAPPA * rx), cy - ry,  cx + rx, cy - (KAPPA * ry), cx + rx, cy);\n\t\t\t\t\tctx.bezierCurveTo(cx + rx, cy + (KAPPA * ry), cx + (KAPPA * rx), cy + ry, cx, cy + ry);\n\t\t\t\t\tctx.bezierCurveTo(cx - (KAPPA * rx), cy + ry, cx - rx, cy + (KAPPA * ry), cx - rx, cy);\n\t\t\t\t\tctx.bezierCurveTo(cx - rx, cy - (KAPPA * ry), cx - (KAPPA * rx), cy - ry, cx, cy - ry);\n\t\t\t\t\tctx.closePath();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn new svg.BoundingBox(cx - rx, cy - ry, cx + rx, cy + ry);\n\t\t\t}\n\t\t}\n\t\tsvg.Element.ellipse.prototype = new svg.Element.PathElementBase;\t\t\t\n\t\t\n\t\t// line element\n\t\tsvg.Element.line = function(node) {\n\t\t\tthis.base = svg.Element.PathElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.getPoints = function() {\n\t\t\t\treturn [\n\t\t\t\t\tnew svg.Point(this.attribute('x1').Length.toPixels('x'), this.attribute('y1').Length.toPixels('y')),\n\t\t\t\t\tnew svg.Point(this.attribute('x2').Length.toPixels('x'), this.attribute('y2').Length.toPixels('y'))];\n\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\tthis.path = function(ctx) {\n\t\t\t\tvar points = this.getPoints();\n\t\t\t\t\n\t\t\t\tif (ctx != null) {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(points[0].x, points[0].y);\n\t\t\t\t\tctx.lineTo(points[1].x, points[1].y);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn new svg.BoundingBox(points[0].x, points[0].y, points[1].x, points[1].y);\n\t\t\t}\n\t\t\t\n\t\t\tthis.getMarkers = function() {\n\t\t\t\tvar points = this.getPoints();\t\n\t\t\t\tvar a = points[0].angleTo(points[1]);\n\t\t\t\treturn [[points[0], a], [points[1], a]];\n\t\t\t}\n\t\t}\n\t\tsvg.Element.line.prototype = new svg.Element.PathElementBase;\t\t\n\t\t\t\t\n\t\t// polyline element\n\t\tsvg.Element.polyline = function(node) {\n\t\t\tthis.base = svg.Element.PathElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.points = svg.CreatePath(this.attribute('points').value);\n\t\t\tthis.path = function(ctx) {\n\t\t\t\tvar bb = new svg.BoundingBox(this.points[0].x, this.points[0].y);\n\t\t\t\tif (ctx != null) {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(this.points[0].x, this.points[0].y);\n\t\t\t\t}\n\t\t\t\tfor (var i=1; i<this.points.length; i++) {\n\t\t\t\t\tbb.addPoint(this.points[i].x, this.points[i].y);\n\t\t\t\t\tif (ctx != null) ctx.lineTo(this.points[i].x, this.points[i].y);\n\t\t\t\t}\n\t\t\t\treturn bb;\n\t\t\t}\n\t\t\t\n\t\t\tthis.getMarkers = function() {\n\t\t\t\tvar markers = [];\n\t\t\t\tfor (var i=0; i<this.points.length - 1; i++) {\n\t\t\t\t\tmarkers.push([this.points[i], this.points[i].angleTo(this.points[i+1])]);\n\t\t\t\t}\n\t\t\t\tmarkers.push([this.points[this.points.length-1], markers[markers.length-1][1]]);\n\t\t\t\treturn markers;\n\t\t\t}\t\t\t\n\t\t}\n\t\tsvg.Element.polyline.prototype = new svg.Element.PathElementBase;\t\t\t\t\n\t\t\t\t\n\t\t// polygon element\n\t\tsvg.Element.polygon = function(node) {\n\t\t\tthis.base = svg.Element.polyline;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.basePath = this.path;\n\t\t\tthis.path = function(ctx) {\n\t\t\t\tvar bb = this.basePath(ctx);\n\t\t\t\tif (ctx != null) {\n\t\t\t\t\tctx.lineTo(this.points[0].x, this.points[0].y);\n\t\t\t\t\tctx.closePath();\n\t\t\t\t}\n\t\t\t\treturn bb;\n\t\t\t}\n\t\t}\n\t\tsvg.Element.polygon.prototype = new svg.Element.polyline;\n\n\t\t// path element\n\t\tsvg.Element.path = function(node) {\n\t\t\tthis.base = svg.Element.PathElementBase;\n\t\t\tthis.base(node);\n\t\t\t\t\t\n\t\t\tvar d = this.attribute('d').value;\n\t\t\t// TODO: convert to real lexer based on http://www.w3.org/TR/SVG11/paths.html#PathDataBNF\n\t\t\td = d.replace(/,/gm,' '); // get rid of all commas\n\t\t\td = d.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,'$1 $2'); // separate commands from commands\n\t\t\td = d.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,'$1 $2'); // separate commands from commands\n\t\t\td = d.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\\s])/gm,'$1 $2'); // separate commands from points\n\t\t\td = d.replace(/([^\\s])([MmZzLlHhVvCcSsQqTtAa])/gm,'$1 $2'); // separate commands from points\n\t\t\td = d.replace(/([0-9])([+\\-])/gm,'$1 $2'); // separate digits when no comma\n\t\t\td = d.replace(/(\\.[0-9]*)(\\.)/gm,'$1 $2'); // separate digits when no comma\n\t\t\td = d.replace(/([Aa](\\s+[0-9]+){3})\\s+([01])\\s*([01])/gm,'$1 $3 $4 '); // shorthand elliptical arc path syntax\n\t\t\td = svg.compressSpaces(d); // compress multiple spaces\n\t\t\td = svg.trim(d);\n\t\t\tthis.PathParser = new (function(d) {\n\t\t\t\tthis.tokens = d.split(' ');\n\t\t\t\t\n\t\t\t\tthis.reset = function() {\n\t\t\t\t\tthis.i = -1;\n\t\t\t\t\tthis.command = '';\n\t\t\t\t\tthis.previousCommand = '';\n\t\t\t\t\tthis.start = new svg.Point(0, 0);\n\t\t\t\t\tthis.control = new svg.Point(0, 0);\n\t\t\t\t\tthis.current = new svg.Point(0, 0);\n\t\t\t\t\tthis.points = [];\n\t\t\t\t\tthis.angles = [];\n\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\tthis.isEnd = function() {\n\t\t\t\t\treturn this.i >= this.tokens.length - 1;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.isCommandOrEnd = function() {\n\t\t\t\t\tif (this.isEnd()) return true;\n\t\t\t\t\treturn this.tokens[this.i + 1].match(/^[A-Za-z]$/) != null;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.isRelativeCommand = function() {\n\t\t\t\t\treturn this.command == this.command.toLowerCase();\n\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\tthis.getToken = function() {\n\t\t\t\t\tthis.i = this.i + 1;\n\t\t\t\t\treturn this.tokens[this.i];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.getScalar = function() {\n\t\t\t\t\treturn parseFloat(this.getToken());\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.nextCommand = function() {\n\t\t\t\t\tthis.previousCommand = this.command;\n\t\t\t\t\tthis.command = this.getToken();\n\t\t\t\t}\t\t\t\t\n\t\t\t\t\n\t\t\t\tthis.getPoint = function() {\n\t\t\t\t\tvar p = new svg.Point(this.getScalar(), this.getScalar());\n\t\t\t\t\treturn this.makeAbsolute(p);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.getAsControlPoint = function() {\n\t\t\t\t\tvar p = this.getPoint();\n\t\t\t\t\tthis.control = p;\n\t\t\t\t\treturn p;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.getAsCurrentPoint = function() {\n\t\t\t\t\tvar p = this.getPoint();\n\t\t\t\t\tthis.current = p;\n\t\t\t\t\treturn p;\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.getReflectedControlPoint = function() {\n\t\t\t\t\tif (this.previousCommand.toLowerCase() != 'c' && this.previousCommand.toLowerCase() != 's') {\n\t\t\t\t\t\treturn this.current;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// reflect point\n\t\t\t\t\tvar p = new svg.Point(2 * this.current.x - this.control.x, 2 * this.current.y - this.control.y);\t\t\t\t\t\n\t\t\t\t\treturn p;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.makeAbsolute = function(p) {\n\t\t\t\t\tif (this.isRelativeCommand()) {\n\t\t\t\t\t\tp.x = this.current.x + p.x;\n\t\t\t\t\t\tp.y = this.current.y + p.y;\n\t\t\t\t\t}\n\t\t\t\t\treturn p;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.addMarker = function(p, from, priorTo) {\n\t\t\t\t\t// if the last angle isn't filled in because we didn't have this point yet ...\n\t\t\t\t\tif (priorTo != null && this.angles.length > 0 && this.angles[this.angles.length-1] == null) {\n\t\t\t\t\t\tthis.angles[this.angles.length-1] = this.points[this.points.length-1].angleTo(priorTo);\n\t\t\t\t\t}\n\t\t\t\t\tthis.addMarkerAngle(p, from == null ? null : from.angleTo(p));\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.addMarkerAngle = function(p, a) {\n\t\t\t\t\tthis.points.push(p);\n\t\t\t\t\tthis.angles.push(a);\n\t\t\t\t}\t\t\t\t\n\t\t\t\t\n\t\t\t\tthis.getMarkerPoints = function() { return this.points; }\n\t\t\t\tthis.getMarkerAngles = function() {\n\t\t\t\t\tfor (var i=0; i<this.angles.length; i++) {\n\t\t\t\t\t\tif (this.angles[i] == null) {\n\t\t\t\t\t\t\tfor (var j=i+1; j<this.angles.length; j++) {\n\t\t\t\t\t\t\t\tif (this.angles[j] != null) {\n\t\t\t\t\t\t\t\t\tthis.angles[i] = this.angles[j];\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this.angles;\n\t\t\t\t}\n\t\t\t})(d);\n\n\t\t\tthis.path = function(ctx) {\n\t\t\t\tvar pp = this.PathParser;\n\t\t\t\tpp.reset();\n\n\t\t\t\tvar bb = new svg.BoundingBox();\n\t\t\t\tif (ctx != null) ctx.beginPath();\n\t\t\t\twhile (!pp.isEnd()) {\n\t\t\t\t\tpp.nextCommand();\n\t\t\t\t\tswitch (pp.command.toUpperCase()) {\n\t\t\t\t\tcase 'M':\n\t\t\t\t\t\tvar p = pp.getAsCurrentPoint();\n\t\t\t\t\t\tpp.addMarker(p);\n\t\t\t\t\t\tbb.addPoint(p.x, p.y);\n\t\t\t\t\t\tif (ctx != null) ctx.moveTo(p.x, p.y);\n\t\t\t\t\t\tpp.start = pp.current;\n\t\t\t\t\t\twhile (!pp.isCommandOrEnd()) {\n\t\t\t\t\t\t\tvar p = pp.getAsCurrentPoint();\n\t\t\t\t\t\t\tpp.addMarker(p, pp.start);\n\t\t\t\t\t\t\tbb.addPoint(p.x, p.y);\n\t\t\t\t\t\t\tif (ctx != null) ctx.lineTo(p.x, p.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'L':\n\t\t\t\t\t\twhile (!pp.isCommandOrEnd()) {\n\t\t\t\t\t\t\tvar c = pp.current;\n\t\t\t\t\t\t\tvar p = pp.getAsCurrentPoint();\n\t\t\t\t\t\t\tpp.addMarker(p, c);\n\t\t\t\t\t\t\tbb.addPoint(p.x, p.y);\n\t\t\t\t\t\t\tif (ctx != null) ctx.lineTo(p.x, p.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'H':\n\t\t\t\t\t\twhile (!pp.isCommandOrEnd()) {\n\t\t\t\t\t\t\tvar newP = new svg.Point((pp.isRelativeCommand() ? pp.current.x : 0) + pp.getScalar(), pp.current.y);\n\t\t\t\t\t\t\tpp.addMarker(newP, pp.current);\n\t\t\t\t\t\t\tpp.current = newP;\n\t\t\t\t\t\t\tbb.addPoint(pp.current.x, pp.current.y);\n\t\t\t\t\t\t\tif (ctx != null) ctx.lineTo(pp.current.x, pp.current.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'V':\n\t\t\t\t\t\twhile (!pp.isCommandOrEnd()) {\n\t\t\t\t\t\t\tvar newP = new svg.Point(pp.current.x, (pp.isRelativeCommand() ? pp.current.y : 0) + pp.getScalar());\n\t\t\t\t\t\t\tpp.addMarker(newP, pp.current);\n\t\t\t\t\t\t\tpp.current = newP;\n\t\t\t\t\t\t\tbb.addPoint(pp.current.x, pp.current.y);\n\t\t\t\t\t\t\tif (ctx != null) ctx.lineTo(pp.current.x, pp.current.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'C':\n\t\t\t\t\t\twhile (!pp.isCommandOrEnd()) {\n\t\t\t\t\t\t\tvar curr = pp.current;\n\t\t\t\t\t\t\tvar p1 = pp.getPoint();\n\t\t\t\t\t\t\tvar cntrl = pp.getAsControlPoint();\n\t\t\t\t\t\t\tvar cp = pp.getAsCurrentPoint();\n\t\t\t\t\t\t\tpp.addMarker(cp, cntrl, p1);\n\t\t\t\t\t\t\tbb.addBezierCurve(curr.x, curr.y, p1.x, p1.y, cntrl.x, cntrl.y, cp.x, cp.y);\n\t\t\t\t\t\t\tif (ctx != null) ctx.bezierCurveTo(p1.x, p1.y, cntrl.x, cntrl.y, cp.x, cp.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'S':\n\t\t\t\t\t\twhile (!pp.isCommandOrEnd()) {\n\t\t\t\t\t\t\tvar curr = pp.current;\n\t\t\t\t\t\t\tvar p1 = pp.getReflectedControlPoint();\n\t\t\t\t\t\t\tvar cntrl = pp.getAsControlPoint();\n\t\t\t\t\t\t\tvar cp = pp.getAsCurrentPoint();\n\t\t\t\t\t\t\tpp.addMarker(cp, cntrl, p1);\n\t\t\t\t\t\t\tbb.addBezierCurve(curr.x, curr.y, p1.x, p1.y, cntrl.x, cntrl.y, cp.x, cp.y);\n\t\t\t\t\t\t\tif (ctx != null) ctx.bezierCurveTo(p1.x, p1.y, cntrl.x, cntrl.y, cp.x, cp.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Q':\n\t\t\t\t\t\twhile (!pp.isCommandOrEnd()) {\n\t\t\t\t\t\t\tvar curr = pp.current;\n\t\t\t\t\t\t\tvar cntrl = pp.getAsControlPoint();\n\t\t\t\t\t\t\tvar cp = pp.getAsCurrentPoint();\n\t\t\t\t\t\t\tpp.addMarker(cp, cntrl, cntrl);\n\t\t\t\t\t\t\tbb.addQuadraticCurve(curr.x, curr.y, cntrl.x, cntrl.y, cp.x, cp.y);\n\t\t\t\t\t\t\tif (ctx != null) ctx.quadraticCurveTo(cntrl.x, cntrl.y, cp.x, cp.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'T':\n\t\t\t\t\t\twhile (!pp.isCommandOrEnd()) {\n\t\t\t\t\t\t\tvar curr = pp.current;\n\t\t\t\t\t\t\tvar cntrl = pp.getReflectedControlPoint();\n\t\t\t\t\t\t\tpp.control = cntrl;\n\t\t\t\t\t\t\tvar cp = pp.getAsCurrentPoint();\n\t\t\t\t\t\t\tpp.addMarker(cp, cntrl, cntrl);\n\t\t\t\t\t\t\tbb.addQuadraticCurve(curr.x, curr.y, cntrl.x, cntrl.y, cp.x, cp.y);\n\t\t\t\t\t\t\tif (ctx != null) ctx.quadraticCurveTo(cntrl.x, cntrl.y, cp.x, cp.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'A':\n\t\t\t\t\t\twhile (!pp.isCommandOrEnd()) {\n\t\t\t\t\t\t    var curr = pp.current;\n\t\t\t\t\t\t\tvar rx = pp.getScalar();\n\t\t\t\t\t\t\tvar ry = pp.getScalar();\n\t\t\t\t\t\t\tvar xAxisRotation = pp.getScalar() * (Math.PI / 180.0);\n\t\t\t\t\t\t\tvar largeArcFlag = pp.getScalar();\n\t\t\t\t\t\t\tvar sweepFlag = pp.getScalar();\n\t\t\t\t\t\t\tvar cp = pp.getAsCurrentPoint();\n\n\t\t\t\t\t\t\t// Conversion from endpoint to center parameterization\n\t\t\t\t\t\t\t// http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n\t\t\t\t\t\t\t// x1', y1'\n\t\t\t\t\t\t\tvar currp = new svg.Point(\n\t\t\t\t\t\t\t\tMath.cos(xAxisRotation) * (curr.x - cp.x) / 2.0 + Math.sin(xAxisRotation) * (curr.y - cp.y) / 2.0,\n\t\t\t\t\t\t\t\t-Math.sin(xAxisRotation) * (curr.x - cp.x) / 2.0 + Math.cos(xAxisRotation) * (curr.y - cp.y) / 2.0\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t// adjust radii\n\t\t\t\t\t\t\tvar l = Math.pow(currp.x,2)/Math.pow(rx,2)+Math.pow(currp.y,2)/Math.pow(ry,2);\n\t\t\t\t\t\t\tif (l > 1) {\n\t\t\t\t\t\t\t\trx *= Math.sqrt(l);\n\t\t\t\t\t\t\t\try *= Math.sqrt(l);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// cx', cy'\n\t\t\t\t\t\t\tvar s = (largeArcFlag == sweepFlag ? -1 : 1) * Math.sqrt(\n\t\t\t\t\t\t\t\t((Math.pow(rx,2)*Math.pow(ry,2))-(Math.pow(rx,2)*Math.pow(currp.y,2))-(Math.pow(ry,2)*Math.pow(currp.x,2))) /\n\t\t\t\t\t\t\t\t(Math.pow(rx,2)*Math.pow(currp.y,2)+Math.pow(ry,2)*Math.pow(currp.x,2))\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (isNaN(s)) s = 0;\n\t\t\t\t\t\t\tvar cpp = new svg.Point(s * rx * currp.y / ry, s * -ry * currp.x / rx);\n\t\t\t\t\t\t\t// cx, cy\n\t\t\t\t\t\t\tvar centp = new svg.Point(\n\t\t\t\t\t\t\t\t(curr.x + cp.x) / 2.0 + Math.cos(xAxisRotation) * cpp.x - Math.sin(xAxisRotation) * cpp.y,\n\t\t\t\t\t\t\t\t(curr.y + cp.y) / 2.0 + Math.sin(xAxisRotation) * cpp.x + Math.cos(xAxisRotation) * cpp.y\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t// vector magnitude\n\t\t\t\t\t\t\tvar m = function(v) { return Math.sqrt(Math.pow(v[0],2) + Math.pow(v[1],2)); }\n\t\t\t\t\t\t\t// ratio between two vectors\n\t\t\t\t\t\t\tvar r = function(u, v) { return (u[0]*v[0]+u[1]*v[1]) / (m(u)*m(v)) }\n\t\t\t\t\t\t\t// angle between two vectors\n\t\t\t\t\t\t\tvar a = function(u, v) { return (u[0]*v[1] < u[1]*v[0] ? -1 : 1) * Math.acos(r(u,v)); }\n\t\t\t\t\t\t\t// initial angle\n\t\t\t\t\t\t\tvar a1 = a([1,0], [(currp.x-cpp.x)/rx,(currp.y-cpp.y)/ry]);\n\t\t\t\t\t\t\t// angle delta\n\t\t\t\t\t\t\tvar u = [(currp.x-cpp.x)/rx,(currp.y-cpp.y)/ry];\n\t\t\t\t\t\t\tvar v = [(-currp.x-cpp.x)/rx,(-currp.y-cpp.y)/ry];\n\t\t\t\t\t\t\tvar ad = a(u, v);\n\t\t\t\t\t\t\tif (r(u,v) <= -1) ad = Math.PI;\n\t\t\t\t\t\t\tif (r(u,v) >= 1) ad = 0;\n\n\t\t\t\t\t\t\tif (sweepFlag == 0 && ad > 0) ad = ad - 2 * Math.PI;\n\t\t\t\t\t\t\tif (sweepFlag == 1 && ad < 0) ad = ad + 2 * Math.PI;\n\n\t\t\t\t\t\t\t// for markers\n\t\t\t\t\t\t\tvar halfWay = new svg.Point(\n\t\t\t\t\t\t\t\tcentp.x - rx * Math.cos((a1 + ad) / 2),\n\t\t\t\t\t\t\t\tcentp.y - ry * Math.sin((a1 + ad) / 2)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tpp.addMarkerAngle(halfWay, (a1 + ad) / 2 + (sweepFlag == 0 ? 1 : -1) * Math.PI / 2);\n\t\t\t\t\t\t\tpp.addMarkerAngle(cp, ad + (sweepFlag == 0 ? 1 : -1) * Math.PI / 2);\n\n\t\t\t\t\t\t\tbb.addPoint(cp.x, cp.y); // TODO: this is too naive, make it better\n\t\t\t\t\t\t\tif (ctx != null) {\n\t\t\t\t\t\t\t\tvar r = rx > ry ? rx : ry;\n\t\t\t\t\t\t\t\tvar sx = rx > ry ? 1 : rx / ry;\n\t\t\t\t\t\t\t\tvar sy = rx > ry ? ry / rx : 1;\n\n\t\t\t\t\t\t\t\tctx.translate(centp.x, centp.y);\n\t\t\t\t\t\t\t\tctx.rotate(xAxisRotation);\n\t\t\t\t\t\t\t\tctx.scale(sx, sy);\n\t\t\t\t\t\t\t\tctx.arc(0, 0, r, a1, a1 + ad, 1 - sweepFlag);\n\t\t\t\t\t\t\t\tctx.scale(1/sx, 1/sy);\n\t\t\t\t\t\t\t\tctx.rotate(-xAxisRotation);\n\t\t\t\t\t\t\t\tctx.translate(-centp.x, -centp.y);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Z':\n\t\t\t\t\t\tif (ctx != null) ctx.closePath();\n\t\t\t\t\t\tpp.current = pp.start;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn bb;\n\t\t\t}\n\n\t\t\tthis.getMarkers = function() {\n\t\t\t\tvar points = this.PathParser.getMarkerPoints();\n\t\t\t\tvar angles = this.PathParser.getMarkerAngles();\n\t\t\t\t\n\t\t\t\tvar markers = [];\n\t\t\t\tfor (var i=0; i<points.length; i++) {\n\t\t\t\t\tmarkers.push([points[i], angles[i]]);\n\t\t\t\t}\n\t\t\t\treturn markers;\n\t\t\t}\n\t\t}\n\t\tsvg.Element.path.prototype = new svg.Element.PathElementBase;\n\t\t\n\t\t// pattern element\n\t\tsvg.Element.pattern = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.createPattern = function(ctx, element) {\n\t\t\t\t// render me using a temporary svg element\n\t\t\t\tvar tempSvg = new svg.Element.svg();\n\t\t\t\ttempSvg.attributes['viewBox'] = new svg.Property('viewBox', this.attribute('viewBox').value);\n\t\t\t\ttempSvg.attributes['x'] = new svg.Property('x', this.attribute('x').value);\n\t\t\t\ttempSvg.attributes['y'] = new svg.Property('y', this.attribute('y').value);\n\t\t\t\ttempSvg.attributes['width'] = new svg.Property('width', this.attribute('width').value);\n\t\t\t\ttempSvg.attributes['height'] = new svg.Property('height', this.attribute('height').value);\n\t\t\t\ttempSvg.children = this.children;\n\t\t\t\t\n\t\t\t\tvar c = document.createElement('canvas');\n\t\t\t\tc.width = this.attribute('width').Length.toPixels('x');\n\t\t\t\tc.height = this.attribute('height').Length.toPixels('y');\n\t\t\t\ttempSvg.render(c.getContext('2d'));\t\t\n\t\t\t\treturn ctx.createPattern(c, 'repeat');\n\t\t\t}\n\t\t}\n\t\tsvg.Element.pattern.prototype = new svg.Element.ElementBase;\n\t\t\n\t\t// marker element\n\t\tsvg.Element.marker = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.baseRender = this.render;\n\t\t\tthis.render = function(ctx, point, angle) {\n\t\t\t\tctx.translate(point.x, point.y);\n\t\t\t\tif (this.attribute('orient').valueOrDefault('auto') == 'auto') ctx.rotate(angle);\n\t\t\t\tif (this.attribute('markerUnits').valueOrDefault('strokeWidth') == 'strokeWidth') ctx.scale(ctx.lineWidth, ctx.lineWidth);\n\t\t\t\tctx.save();\n\t\t\t\t\t\t\t\n\t\t\t\t// render me using a temporary svg element\n\t\t\t\tvar tempSvg = new svg.Element.svg();\n\t\t\t\ttempSvg.attributes['viewBox'] = new svg.Property('viewBox', this.attribute('viewBox').value);\n\t\t\t\ttempSvg.attributes['refX'] = new svg.Property('refX', this.attribute('refX').value);\n\t\t\t\ttempSvg.attributes['refY'] = new svg.Property('refY', this.attribute('refY').value);\n\t\t\t\ttempSvg.attributes['width'] = new svg.Property('width', this.attribute('markerWidth').value);\n\t\t\t\ttempSvg.attributes['height'] = new svg.Property('height', this.attribute('markerHeight').value);\n\t\t\t\ttempSvg.attributes['fill'] = new svg.Property('fill', this.attribute('fill').valueOrDefault('black'));\n\t\t\t\ttempSvg.attributes['stroke'] = new svg.Property('stroke', this.attribute('stroke').valueOrDefault('none'));\n\t\t\t\ttempSvg.children = this.children;\n\t\t\t\ttempSvg.render(ctx);\n\t\t\t\t\n\t\t\t\tctx.restore();\n\t\t\t\tif (this.attribute('markerUnits').valueOrDefault('strokeWidth') == 'strokeWidth') ctx.scale(1/ctx.lineWidth, 1/ctx.lineWidth);\n\t\t\t\tif (this.attribute('orient').valueOrDefault('auto') == 'auto') ctx.rotate(-angle);\n\t\t\t\tctx.translate(-point.x, -point.y);\n\t\t\t}\n\t\t}\n\t\tsvg.Element.marker.prototype = new svg.Element.ElementBase;\n\t\t\n\t\t// definitions element\n\t\tsvg.Element.defs = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\t\n\t\t\t\n\t\t\tthis.render = function(ctx) {\n\t\t\t\t// NOOP\n\t\t\t}\n\t\t}\n\t\tsvg.Element.defs.prototype = new svg.Element.ElementBase;\n\t\t\n\t\t// base for gradients\n\t\tsvg.Element.GradientBase = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.gradientUnits = this.attribute('gradientUnits').valueOrDefault('objectBoundingBox');\n\t\t\t\n\t\t\tthis.stops = [];\t\t\t\n\t\t\tfor (var i=0; i<this.children.length; i++) {\n\t\t\t\tvar child = this.children[i];\n\t\t\t\tthis.stops.push(child);\n\t\t\t}\t\n\t\t\t\n\t\t\tthis.getGradient = function() {\n\t\t\t\t// OVERRIDE ME!\n\t\t\t}\t\t\t\n\n\t\t\tthis.createGradient = function(ctx, element) {\n\t\t\t\tvar stopsContainer = this;\n\t\t\t\tif (this.attribute('xlink:href').hasValue()) {\n\t\t\t\t\tstopsContainer = this.attribute('xlink:href').Definition.getDefinition();\n\t\t\t\t}\n\t\t\t\n\t\t\t\tvar g = this.getGradient(ctx, element);\n\t\t\t\tfor (var i=0; i<stopsContainer.stops.length; i++) {\n\t\t\t\t\tg.addColorStop(stopsContainer.stops[i].offset, stopsContainer.stops[i].color);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (this.attribute('gradientTransform').hasValue()) {\n\t\t\t\t\t// render as transformed pattern on temporary canvas\n\t\t\t\t\tvar rootView = svg.ViewPort.viewPorts[0];\n\t\t\t\t\t\n\t\t\t\t\tvar rect = new svg.Element.rect();\n\t\t\t\t\trect.attributes['x'] = new svg.Property('x', -svg.MAX_VIRTUAL_PIXELS/3.0);\n\t\t\t\t\trect.attributes['y'] = new svg.Property('y', -svg.MAX_VIRTUAL_PIXELS/3.0);\n\t\t\t\t\trect.attributes['width'] = new svg.Property('width', svg.MAX_VIRTUAL_PIXELS);\n\t\t\t\t\trect.attributes['height'] = new svg.Property('height', svg.MAX_VIRTUAL_PIXELS);\n\t\t\t\t\t\n\t\t\t\t\tvar group = new svg.Element.g();\n\t\t\t\t\tgroup.attributes['transform'] = new svg.Property('transform', this.attribute('gradientTransform').value);\n\t\t\t\t\tgroup.children = [ rect ];\n\t\t\t\t\t\n\t\t\t\t\tvar tempSvg = new svg.Element.svg();\n\t\t\t\t\ttempSvg.attributes['x'] = new svg.Property('x', 0);\n\t\t\t\t\ttempSvg.attributes['y'] = new svg.Property('y', 0);\n\t\t\t\t\ttempSvg.attributes['width'] = new svg.Property('width', rootView.width);\n\t\t\t\t\ttempSvg.attributes['height'] = new svg.Property('height', rootView.height);\n\t\t\t\t\ttempSvg.children = [ group ];\n\t\t\t\t\t\n\t\t\t\t\tvar c = document.createElement('canvas');\n\t\t\t\t\tc.width = rootView.width;\n\t\t\t\t\tc.height = rootView.height;\n\t\t\t\t\tvar tempCtx = c.getContext('2d');\n\t\t\t\t\ttempCtx.fillStyle = g;\n\t\t\t\t\ttempSvg.render(tempCtx);\t\t\n\t\t\t\t\treturn tempCtx.createPattern(c, 'no-repeat');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn g;\t\t\t\t\n\t\t\t}\n\t\t}\n\t\tsvg.Element.GradientBase.prototype = new svg.Element.ElementBase;\n\t\t\n\t\t// linear gradient element\n\t\tsvg.Element.linearGradient = function(node) {\n\t\t\tthis.base = svg.Element.GradientBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.getGradient = function(ctx, element) {\n\t\t\t\tvar bb = element.getBoundingBox();\n\t\t\t\t\n\t\t\t\tvar x1 = (this.gradientUnits == 'objectBoundingBox' \n\t\t\t\t\t? bb.x() + bb.width() * this.attribute('x1').numValue() \n\t\t\t\t\t: this.attribute('x1').Length.toPixels('x'));\n\t\t\t\tvar y1 = (this.gradientUnits == 'objectBoundingBox' \n\t\t\t\t\t? bb.y() + bb.height() * this.attribute('y1').numValue()\n\t\t\t\t\t: this.attribute('y1').Length.toPixels('y'));\n\t\t\t\tvar x2 = (this.gradientUnits == 'objectBoundingBox' \n\t\t\t\t\t? bb.x() + bb.width() * this.attribute('x2').numValue()\n\t\t\t\t\t: this.attribute('x2').Length.toPixels('x'));\n\t\t\t\tvar y2 = (this.gradientUnits == 'objectBoundingBox' \n\t\t\t\t\t? bb.y() + bb.height() * this.attribute('y2').numValue()\n\t\t\t\t\t: this.attribute('y2').Length.toPixels('y'));\n\n\t\t\t\treturn ctx.createLinearGradient(x1, y1, x2, y2);\n\t\t\t}\n\t\t}\n\t\tsvg.Element.linearGradient.prototype = new svg.Element.GradientBase;\n\t\t\n\t\t// radial gradient element\n\t\tsvg.Element.radialGradient = function(node) {\n\t\t\tthis.base = svg.Element.GradientBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.getGradient = function(ctx, element) {\n\t\t\t\tvar bb = element.getBoundingBox();\n\t\t\t\t\n\t\t\t\tvar cx = (this.gradientUnits == 'objectBoundingBox' \n\t\t\t\t\t? bb.x() + bb.width() * this.attribute('cx').numValue() \n\t\t\t\t\t: this.attribute('cx').Length.toPixels('x'));\n\t\t\t\tvar cy = (this.gradientUnits == 'objectBoundingBox' \n\t\t\t\t\t? bb.y() + bb.height() * this.attribute('cy').numValue() \n\t\t\t\t\t: this.attribute('cy').Length.toPixels('y'));\n\t\t\t\t\n\t\t\t\tvar fx = cx;\n\t\t\t\tvar fy = cy;\n\t\t\t\tif (this.attribute('fx').hasValue()) {\n\t\t\t\t\tfx = (this.gradientUnits == 'objectBoundingBox' \n\t\t\t\t\t? bb.x() + bb.width() * this.attribute('fx').numValue() \n\t\t\t\t\t: this.attribute('fx').Length.toPixels('x'));\n\t\t\t\t}\n\t\t\t\tif (this.attribute('fy').hasValue()) {\n\t\t\t\t\tfy = (this.gradientUnits == 'objectBoundingBox' \n\t\t\t\t\t? bb.y() + bb.height() * this.attribute('fy').numValue() \n\t\t\t\t\t: this.attribute('fy').Length.toPixels('y'));\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar r = (this.gradientUnits == 'objectBoundingBox' \n\t\t\t\t\t? (bb.width() + bb.height()) / 2.0 * this.attribute('r').numValue()\n\t\t\t\t\t: this.attribute('r').Length.toPixels());\n\t\t\t\t\n\t\t\t\treturn ctx.createRadialGradient(fx, fy, 0, cx, cy, r);\n\t\t\t}\n\t\t}\n\t\tsvg.Element.radialGradient.prototype = new svg.Element.GradientBase;\n\t\t\n\t\t// gradient stop element\n\t\tsvg.Element.stop = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.offset = this.attribute('offset').numValue();\n\t\t\t\n\t\t\tvar stopColor = this.style('stop-color');\n\t\t\tif (this.style('stop-opacity').hasValue()) stopColor = stopColor.Color.addOpacity(this.style('stop-opacity').value);\n\t\t\tthis.color = stopColor.value;\n\t\t}\n\t\tsvg.Element.stop.prototype = new svg.Element.ElementBase;\n\t\t\n\t\t// animation base element\n\t\tsvg.Element.AnimateBase = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tsvg.Animations.push(this);\n\t\t\t\n\t\t\tthis.duration = 0.0;\n\t\t\tthis.begin = this.attribute('begin').Time.toMilliseconds();\n\t\t\tthis.maxDuration = this.begin + this.attribute('dur').Time.toMilliseconds();\n\t\t\t\n\t\t\tthis.getProperty = function() {\n\t\t\t\tvar attributeType = this.attribute('attributeType').value;\n\t\t\t\tvar attributeName = this.attribute('attributeName').value;\n\t\t\t\t\n\t\t\t\tif (attributeType == 'CSS') {\n\t\t\t\t\treturn this.parent.style(attributeName, true);\n\t\t\t\t}\n\t\t\t\treturn this.parent.attribute(attributeName, true);\t\t\t\n\t\t\t};\n\t\t\t\n\t\t\tthis.initialValue = null;\n\t\t\tthis.removed = false;\t\t\t\n\n\t\t\tthis.calcValue = function() {\n\t\t\t\t// OVERRIDE ME!\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\t\n\t\t\tthis.update = function(delta) {\t\n\t\t\t\t// set initial value\n\t\t\t\tif (this.initialValue == null) {\n\t\t\t\t\tthis.initialValue = this.getProperty().value;\n\t\t\t\t}\n\t\t\t\n\t\t\t\t// if we're past the end time\n\t\t\t\tif (this.duration > this.maxDuration) {\n\t\t\t\t\t// loop for indefinitely repeating animations\n\t\t\t\t\tif (this.attribute('repeatCount').value == 'indefinite') {\n\t\t\t\t\t\tthis.duration = 0.0\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.attribute('fill').valueOrDefault('remove') == 'remove' && !this.removed) {\n\t\t\t\t\t\tthis.removed = true;\n\t\t\t\t\t\tthis.getProperty().value = this.initialValue;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\treturn false; // no updates made\n\t\t\t\t\t}\n\t\t\t\t}\t\t\t\n\t\t\t\tthis.duration = this.duration + delta;\n\t\t\t\n\t\t\t\t// if we're past the begin time\n\t\t\t\tvar updated = false;\n\t\t\t\tif (this.begin < this.duration) {\n\t\t\t\t\tvar newValue = this.calcValue(); // tween\n\t\t\t\t\t\n\t\t\t\t\tif (this.attribute('type').hasValue()) {\n\t\t\t\t\t\t// for transform, etc.\n\t\t\t\t\t\tvar type = this.attribute('type').value;\n\t\t\t\t\t\tnewValue = type + '(' + newValue + ')';\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.getProperty().value = newValue;\n\t\t\t\t\tupdated = true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn updated;\n\t\t\t}\n\t\t\t\n\t\t\t// fraction of duration we've covered\n\t\t\tthis.progress = function() {\n\t\t\t\treturn ((this.duration - this.begin) / (this.maxDuration - this.begin));\n\t\t\t}\t\t\t\n\t\t}\n\t\tsvg.Element.AnimateBase.prototype = new svg.Element.ElementBase;\n\t\t\n\t\t// animate element\n\t\tsvg.Element.animate = function(node) {\n\t\t\tthis.base = svg.Element.AnimateBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.calcValue = function() {\n\t\t\t\tvar from = this.attribute('from').numValue();\n\t\t\t\tvar to = this.attribute('to').numValue();\n\t\t\t\t\n\t\t\t\t// tween value linearly\n\t\t\t\treturn from + (to - from) * this.progress(); \n\t\t\t};\n\t\t}\n\t\tsvg.Element.animate.prototype = new svg.Element.AnimateBase;\n\t\t\t\n\t\t// animate color element\n\t\tsvg.Element.animateColor = function(node) {\n\t\t\tthis.base = svg.Element.AnimateBase;\n\t\t\tthis.base(node);\n\n\t\t\tthis.calcValue = function() {\n\t\t\t\tvar from = new RGBColor(this.attribute('from').value);\n\t\t\t\tvar to = new RGBColor(this.attribute('to').value);\n\t\t\t\t\n\t\t\t\tif (from.ok && to.ok) {\n\t\t\t\t\t// tween color linearly\n\t\t\t\t\tvar r = from.r + (to.r - from.r) * this.progress();\n\t\t\t\t\tvar g = from.g + (to.g - from.g) * this.progress();\n\t\t\t\t\tvar b = from.b + (to.b - from.b) * this.progress();\n\t\t\t\t\treturn 'rgb('+parseInt(r,10)+','+parseInt(g,10)+','+parseInt(b,10)+')';\n\t\t\t\t}\n\t\t\t\treturn this.attribute('from').value;\n\t\t\t};\n\t\t}\n\t\tsvg.Element.animateColor.prototype = new svg.Element.AnimateBase;\n\t\t\n\t\t// animate transform element\n\t\tsvg.Element.animateTransform = function(node) {\n\t\t\tthis.base = svg.Element.animate;\n\t\t\tthis.base(node);\n\t\t}\n\t\tsvg.Element.animateTransform.prototype = new svg.Element.animate;\n\t\t\n\t\t// font element\n\t\tsvg.Element.font = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\n\n\t\t\tthis.horizAdvX = this.attribute('horiz-adv-x').numValue();\t\t\t\n\t\t\t\n\t\t\tthis.isRTL = false;\n\t\t\tthis.isArabic = false;\n\t\t\tthis.fontFace = null;\n\t\t\tthis.missingGlyph = null;\n\t\t\tthis.glyphs = [];\t\t\t\n\t\t\tfor (var i=0; i<this.children.length; i++) {\n\t\t\t\tvar child = this.children[i];\n\t\t\t\tif (child.type == 'font-face') {\n\t\t\t\t\tthis.fontFace = child;\n\t\t\t\t\tif (child.style('font-family').hasValue()) {\n\t\t\t\t\t\tsvg.Definitions[child.style('font-family').value] = this;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (child.type == 'missing-glyph') this.missingGlyph = child;\n\t\t\t\telse if (child.type == 'glyph') {\n\t\t\t\t\tif (child.arabicForm != '') {\n\t\t\t\t\t\tthis.isRTL = true;\n\t\t\t\t\t\tthis.isArabic = true;\n\t\t\t\t\t\tif (typeof(this.glyphs[child.unicode]) == 'undefined') this.glyphs[child.unicode] = [];\n\t\t\t\t\t\tthis.glyphs[child.unicode][child.arabicForm] = child;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.glyphs[child.unicode] = child;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\t\n\t\t}\n\t\tsvg.Element.font.prototype = new svg.Element.ElementBase;\n\t\t\n\t\t// font-face element\n\t\tsvg.Element.fontface = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\t\n\t\t\t\n\t\t\tthis.ascent = this.attribute('ascent').value;\n\t\t\tthis.descent = this.attribute('descent').value;\n\t\t\tthis.unitsPerEm = this.attribute('units-per-em').numValue();\t\t\t\t\n\t\t}\n\t\tsvg.Element.fontface.prototype = new svg.Element.ElementBase;\n\t\t\n\t\t// missing-glyph element\n\t\tsvg.Element.missingglyph = function(node) {\n\t\t\tthis.base = svg.Element.path;\n\t\t\tthis.base(node);\t\n\t\t\t\n\t\t\tthis.horizAdvX = 0;\n\t\t}\n\t\tsvg.Element.missingglyph.prototype = new svg.Element.path;\n\t\t\n\t\t// glyph element\n\t\tsvg.Element.glyph = function(node) {\n\t\t\tthis.base = svg.Element.path;\n\t\t\tthis.base(node);\t\n\t\t\t\n\t\t\tthis.horizAdvX = this.attribute('horiz-adv-x').numValue();\n\t\t\tthis.unicode = this.attribute('unicode').value;\n\t\t\tthis.arabicForm = this.attribute('arabic-form').value;\n\t\t}\n\t\tsvg.Element.glyph.prototype = new svg.Element.path;\n\t\t\n\t\t// text element\n\t\tsvg.Element.text = function(node) {\n\t\t\tthis.base = svg.Element.RenderedElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tif (node != null) {\n\t\t\t\t// add children\n\t\t\t\tthis.children = [];\n\t\t\t\tfor (var i=0; i<node.childNodes.length; i++) {\n\t\t\t\t\tvar childNode = node.childNodes[i];\n\t\t\t\t\tif (childNode.nodeType == 1) { // capture tspan and tref nodes\n\t\t\t\t\t\tthis.addChild(childNode, true);\n\t\t\t\t\t}\n\t\t\t\t\telse if (childNode.nodeType == 3) { // capture text\n\t\t\t\t\t\tthis.addChild(new svg.Element.tspan(childNode), false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.baseSetContext = this.setContext;\n\t\t\tthis.setContext = function(ctx) {\n\t\t\t\tthis.baseSetContext(ctx);\n\t\t\t\tif (this.style('dominant-baseline').hasValue()) ctx.textBaseline = this.style('dominant-baseline').value;\n\t\t\t\tif (this.style('alignment-baseline').hasValue()) ctx.textBaseline = this.style('alignment-baseline').value;\n\t\t\t}\n\t\t\t\n\t\t\tthis.renderChildren = function(ctx) {\n\t\t\t\tvar textAnchor = this.style('text-anchor').valueOrDefault('start');\n\t\t\t\tvar x = this.attribute('x').Length.toPixels('x');\n\t\t\t\tvar y = this.attribute('y').Length.toPixels('y');\n\t\t\t\tfor (var i=0; i<this.children.length; i++) {\n\t\t\t\t\tvar child = this.children[i];\n\t\t\t\t\n\t\t\t\t\tif (child.attribute('x').hasValue()) {\n\t\t\t\t\t\tchild.x = child.attribute('x').Length.toPixels('x');\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (child.attribute('dx').hasValue()) x += child.attribute('dx').Length.toPixels('x');\n\t\t\t\t\t\tchild.x = x;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar childLength = child.measureText(ctx);\n\t\t\t\t\tif (textAnchor != 'start' && (i==0 || child.attribute('x').hasValue())) { // new group?\n\t\t\t\t\t\t// loop through rest of children\n\t\t\t\t\t\tvar groupLength = childLength;\n\t\t\t\t\t\tfor (var j=i+1; j<this.children.length; j++) {\n\t\t\t\t\t\t\tvar childInGroup = this.children[j];\n\t\t\t\t\t\t\tif (childInGroup.attribute('x').hasValue()) break; // new group\n\t\t\t\t\t\t\tgroupLength += childInGroup.measureText(ctx);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchild.x -= (textAnchor == 'end' ? groupLength : groupLength / 2.0);\n\t\t\t\t\t}\n\t\t\t\t\tx = child.x + childLength;\n\t\t\t\t\t\n\t\t\t\t\tif (child.attribute('y').hasValue()) {\n\t\t\t\t\t\tchild.y = child.attribute('y').Length.toPixels('y');\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (child.attribute('dy').hasValue()) y += child.attribute('dy').Length.toPixels('y');\n\t\t\t\t\t\tchild.y = y;\n\t\t\t\t\t}\t\n\t\t\t\t\ty = child.y;\n\t\t\t\t\t\n\t\t\t\t\tchild.render(ctx);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsvg.Element.text.prototype = new svg.Element.RenderedElementBase;\n\t\t\n\t\t// text base\n\t\tsvg.Element.TextElementBase = function(node) {\n\t\t\tthis.base = svg.Element.RenderedElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.getGlyph = function(font, text, i) {\n\t\t\t\tvar c = text[i];\n\t\t\t\tvar glyph = null;\n\t\t\t\tif (font.isArabic) {\n\t\t\t\t\tvar arabicForm = 'isolated';\n\t\t\t\t\tif ((i==0 || text[i-1]==' ') && i<text.length-2 && text[i+1]!=' ') arabicForm = 'terminal'; \n\t\t\t\t\tif (i>0 && text[i-1]!=' ' && i<text.length-2 && text[i+1]!=' ') arabicForm = 'medial';\n\t\t\t\t\tif (i>0 && text[i-1]!=' ' && (i == text.length-1 || text[i+1]==' ')) arabicForm = 'initial';\n\t\t\t\t\tif (typeof(font.glyphs[c]) != 'undefined') {\n\t\t\t\t\t\tglyph = font.glyphs[c][arabicForm];\n\t\t\t\t\t\tif (glyph == null && font.glyphs[c].type == 'glyph') glyph = font.glyphs[c];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tglyph = font.glyphs[c];\n\t\t\t\t}\n\t\t\t\tif (glyph == null) glyph = font.missingGlyph;\n\t\t\t\treturn glyph;\n\t\t\t}\n\t\t\t\n\t\t\tthis.renderChildren = function(ctx) {\n\t\t\t\tvar customFont = this.parent.style('font-family').Definition.getDefinition();\n\t\t\t\tif (customFont != null) {\n\t\t\t\t\tvar fontSize = this.parent.style('font-size').numValueOrDefault(svg.Font.Parse(svg.ctx.font).fontSize);\n\t\t\t\t\tvar fontStyle = this.parent.style('font-style').valueOrDefault(svg.Font.Parse(svg.ctx.font).fontStyle);\n\t\t\t\t\tvar text = this.getText();\n\t\t\t\t\tif (customFont.isRTL) text = text.split(\"\").reverse().join(\"\");\n\t\t\t\t\t\n\t\t\t\t\tvar dx = svg.ToNumberArray(this.parent.attribute('dx').value);\n\t\t\t\t\tfor (var i=0; i<text.length; i++) {\n\t\t\t\t\t\tvar glyph = this.getGlyph(customFont, text, i);\n\t\t\t\t\t\tvar scale = fontSize / customFont.fontFace.unitsPerEm;\n\t\t\t\t\t\tctx.translate(this.x, this.y);\n\t\t\t\t\t\tctx.scale(scale, -scale);\n\t\t\t\t\t\tvar lw = ctx.lineWidth;\n\t\t\t\t\t\tctx.lineWidth = ctx.lineWidth * customFont.fontFace.unitsPerEm / fontSize;\n\t\t\t\t\t\tif (fontStyle == 'italic') ctx.transform(1, 0, .4, 1, 0, 0);\n\t\t\t\t\t\tglyph.render(ctx);\n\t\t\t\t\t\tif (fontStyle == 'italic') ctx.transform(1, 0, -.4, 1, 0, 0);\n\t\t\t\t\t\tctx.lineWidth = lw;\n\t\t\t\t\t\tctx.scale(1/scale, -1/scale);\n\t\t\t\t\t\tctx.translate(-this.x, -this.y);\t\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.x += fontSize * (glyph.horizAdvX || customFont.horizAdvX) / customFont.fontFace.unitsPerEm;\n\t\t\t\t\t\tif (typeof(dx[i]) != 'undefined' && !isNaN(dx[i])) {\n\t\t\t\t\t\t\tthis.x += dx[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\n\t\t\t\tif (ctx.strokeStyle != '') ctx.strokeText(svg.compressSpaces(this.getText()), this.x, this.y);\n\t\t\t\tif (ctx.fillStyle != '') ctx.fillText(svg.compressSpaces(this.getText()), this.x, this.y);\n\t\t\t}\n\t\t\t\n\t\t\tthis.getText = function() {\n\t\t\t\t// OVERRIDE ME\n\t\t\t}\n\t\t\t\n\t\t\tthis.measureText = function(ctx) {\n\t\t\t\tvar customFont = this.parent.style('font-family').Definition.getDefinition();\n\t\t\t\tif (customFont != null) {\n\t\t\t\t\tvar fontSize = this.parent.style('font-size').numValueOrDefault(svg.Font.Parse(svg.ctx.font).fontSize);\n\t\t\t\t\tvar measure = 0;\n\t\t\t\t\tvar text = this.getText();\n\t\t\t\t\tif (customFont.isRTL) text = text.split(\"\").reverse().join(\"\");\n\t\t\t\t\tvar dx = svg.ToNumberArray(this.parent.attribute('dx').value);\n\t\t\t\t\tfor (var i=0; i<text.length; i++) {\n\t\t\t\t\t\tvar glyph = this.getGlyph(customFont, text, i);\n\t\t\t\t\t\tmeasure += (glyph.horizAdvX || customFont.horizAdvX) * fontSize / customFont.fontFace.unitsPerEm;\n\t\t\t\t\t\tif (typeof(dx[i]) != 'undefined' && !isNaN(dx[i])) {\n\t\t\t\t\t\t\tmeasure += dx[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn measure;\n\t\t\t\t}\n\t\t\t\n\t\t\t\tvar textToMeasure = svg.compressSpaces(this.getText());\n\t\t\t\tif (!ctx.measureText) return textToMeasure.length * 10;\n\t\t\t\t\n\t\t\t\tctx.save();\n\t\t\t\tthis.setContext(ctx);\n\t\t\t\tvar width = ctx.measureText(textToMeasure).width;\n\t\t\t\tctx.restore();\n\t\t\t\treturn width;\n\t\t\t}\n\t\t}\n\t\tsvg.Element.TextElementBase.prototype = new svg.Element.RenderedElementBase;\n\t\t\n\t\t// tspan \n\t\tsvg.Element.tspan = function(node) {\n\t\t\tthis.base = svg.Element.TextElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.text = node.nodeType == 3 ? node.nodeValue : // text\n\t\t\t\t\t\tnode.childNodes.length > 0 ? node.childNodes[0].nodeValue : // element\n\t\t\t\t\t\tnode.text;\n\t\t\tthis.getText = function() {\n\t\t\t\treturn this.text;\n\t\t\t}\n\t\t}\n\t\tsvg.Element.tspan.prototype = new svg.Element.TextElementBase;\n\t\t\n\t\t// tref\n\t\tsvg.Element.tref = function(node) {\n\t\t\tthis.base = svg.Element.TextElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.getText = function() {\n\t\t\t\tvar element = this.attribute('xlink:href').Definition.getDefinition();\n\t\t\t\tif (element != null) return element.children[0].getText();\n\t\t\t}\n\t\t}\n\t\tsvg.Element.tref.prototype = new svg.Element.TextElementBase;\t\t\n\t\t\n\t\t// a element\n\t\tsvg.Element.a = function(node) {\n\t\t\tthis.base = svg.Element.TextElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.hasText = true;\n\t\t\tfor (var i=0; i<node.childNodes.length; i++) {\n\t\t\t\tif (node.childNodes[i].nodeType != 3) this.hasText = false;\n\t\t\t}\n\t\t\t\n\t\t\t// this might contain text\n\t\t\tthis.text = this.hasText ? node.childNodes[0].nodeValue : '';\n\t\t\tthis.getText = function() {\n\t\t\t\treturn this.text;\n\t\t\t}\t\t\n\n\t\t\tthis.baseRenderChildren = this.renderChildren;\n\t\t\tthis.renderChildren = function(ctx) {\n\t\t\t\tif (this.hasText) {\n\t\t\t\t\t// render as text element\n\t\t\t\t\tthis.baseRenderChildren(ctx);\n\t\t\t\t\tvar fontSize = new svg.Property('fontSize', svg.Font.Parse(svg.ctx.font).fontSize);\n\t\t\t\t\tsvg.Mouse.checkBoundingBox(this, new svg.BoundingBox(this.x, this.y - fontSize.Length.toPixels('y'), this.x + this.measureText(ctx), this.y));\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// render as temporary group\n\t\t\t\t\tvar g = new svg.Element.g();\n\t\t\t\t\tg.children = this.children;\n\t\t\t\t\tg.parent = this;\n\t\t\t\t\tg.render(ctx);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.onclick = function() {\n\t\t\t\twindow.open(this.attribute('xlink:href').value);\n\t\t\t}\n\t\t\t\n\t\t\tthis.onmousemove = function() {\n\t\t\t\tsvg.ctx.canvas.style.cursor = 'pointer';\n\t\t\t}\n\t\t}\n\t\tsvg.Element.a.prototype = new svg.Element.TextElementBase;\t\t\n\t\t\n\t\t// image element\n\t\tsvg.Element.image = function(node) {\n\t\t\tthis.base = svg.Element.RenderedElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tsvg.Images.push(this);\n\t\t\tthis.img = document.createElement('img');\n\t\t\tthis.loaded = false;\n\t\t\tvar that = this;\n\t\t\tthis.img.onload = function() { that.loaded = true; }\n\t\t\tthis.img.src = this.attribute('xlink:href').value;\n\t\t\t\n\t\t\tthis.renderChildren = function(ctx) {\n\t\t\t\tvar x = this.attribute('x').Length.toPixels('x');\n\t\t\t\tvar y = this.attribute('y').Length.toPixels('y');\n\t\t\t\t\n\t\t\t\tvar width = this.attribute('width').Length.toPixels('x');\n\t\t\t\tvar height = this.attribute('height').Length.toPixels('y');\t\t\t\n\t\t\t\tif (width == 0 || height == 0) return;\n\t\t\t\n\t\t\t\tctx.save();\n\t\t\t\tctx.translate(x, y);\n\t\t\t\tsvg.AspectRatio(ctx,\n\t\t\t\t\t\t\t\tthis.attribute('preserveAspectRatio').value,\n\t\t\t\t\t\t\t\twidth,\n\t\t\t\t\t\t\t\tthis.img.width,\n\t\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t\t\tthis.img.height,\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t0);\t\n\t\t\t\tctx.drawImage(this.img, 0, 0);\t\t\t\n\t\t\t\tctx.restore();\n\t\t\t}\n\t\t}\n\t\tsvg.Element.image.prototype = new svg.Element.RenderedElementBase;\n\t\t\n\t\t// group element\n\t\tsvg.Element.g = function(node) {\n\t\t\tthis.base = svg.Element.RenderedElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.getBoundingBox = function() {\n\t\t\t\tvar bb = new svg.BoundingBox();\n\t\t\t\tfor (var i=0; i<this.children.length; i++) {\n\t\t\t\t\tbb.addBoundingBox(this.children[i].getBoundingBox());\n\t\t\t\t}\n\t\t\t\treturn bb;\n\t\t\t};\n\t\t}\n\t\tsvg.Element.g.prototype = new svg.Element.RenderedElementBase;\n\n\t\t// symbol element\n\t\tsvg.Element.symbol = function(node) {\n\t\t\tthis.base = svg.Element.RenderedElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.baseSetContext = this.setContext;\n\t\t\tthis.setContext = function(ctx) {\t\t\n\t\t\t\tthis.baseSetContext(ctx);\n\t\t\t\t\n\t\t\t\t// viewbox\n\t\t\t\tif (this.attribute('viewBox').hasValue()) {\t\t\t\t\n\t\t\t\t\tvar viewBox = svg.ToNumberArray(this.attribute('viewBox').value);\n\t\t\t\t\tvar minX = viewBox[0];\n\t\t\t\t\tvar minY = viewBox[1];\n\t\t\t\t\twidth = viewBox[2];\n\t\t\t\t\theight = viewBox[3];\n\t\t\t\t\t\n\t\t\t\t\tsvg.AspectRatio(ctx,\n\t\t\t\t\t\t\t\t\tthis.attribute('preserveAspectRatio').value, \n\t\t\t\t\t\t\t\t\tthis.attribute('width').Length.toPixels('x'),\n\t\t\t\t\t\t\t\t\twidth,\n\t\t\t\t\t\t\t\t\tthis.attribute('height').Length.toPixels('y'),\n\t\t\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t\t\t\tminX,\n\t\t\t\t\t\t\t\t\tminY);\n\n\t\t\t\t\tsvg.ViewPort.SetCurrent(viewBox[2], viewBox[3]);\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t}\n\t\tsvg.Element.symbol.prototype = new svg.Element.RenderedElementBase;\t\t\n\t\t\t\n\t\t// style element\n\t\tsvg.Element.style = function(node) { \n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\t// text, or spaces then CDATA\n\t\t\tvar css = node.childNodes[0].nodeValue + (node.childNodes.length > 1 ? node.childNodes[1].nodeValue : '');\n\t\t\tcss = css.replace(/(\\/\\*([^*]|[\\r\\n]|(\\*+([^*\\/]|[\\r\\n])))*\\*+\\/)|(^[\\s]*\\/\\/.*)/gm, ''); // remove comments\n\t\t\tcss = svg.compressSpaces(css); // replace whitespace\n\t\t\tvar cssDefs = css.split('}');\n\t\t\tfor (var i=0; i<cssDefs.length; i++) {\n\t\t\t\tif (svg.trim(cssDefs[i]) != '') {\n\t\t\t\t\tvar cssDef = cssDefs[i].split('{');\n\t\t\t\t\tvar cssClasses = cssDef[0].split(',');\n\t\t\t\t\tvar cssProps = cssDef[1].split(';');\n\t\t\t\t\tfor (var j=0; j<cssClasses.length; j++) {\n\t\t\t\t\t\tvar cssClass = svg.trim(cssClasses[j]);\n\t\t\t\t\t\tif (cssClass != '') {\n\t\t\t\t\t\t\tvar props = {};\n\t\t\t\t\t\t\tfor (var k=0; k<cssProps.length; k++) {\n\t\t\t\t\t\t\t\tvar prop = cssProps[k].indexOf(':');\n\t\t\t\t\t\t\t\tvar name = cssProps[k].substr(0, prop);\n\t\t\t\t\t\t\t\tvar value = cssProps[k].substr(prop + 1, cssProps[k].length - prop);\n\t\t\t\t\t\t\t\tif (name != null && value != null) {\n\t\t\t\t\t\t\t\t\tprops[svg.trim(name)] = new svg.Property(svg.trim(name), svg.trim(value));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsvg.Styles[cssClass] = props;\n\t\t\t\t\t\t\tif (cssClass == '@font-face') {\n\t\t\t\t\t\t\t\tvar fontFamily = props['font-family'].value.replace(/\"/g,'');\n\t\t\t\t\t\t\t\tvar srcs = props['src'].value.split(',');\n\t\t\t\t\t\t\t\tfor (var s=0; s<srcs.length; s++) {\n\t\t\t\t\t\t\t\t\tif (srcs[s].indexOf('format(\"svg\")') > 0) {\n\t\t\t\t\t\t\t\t\t\tvar urlStart = srcs[s].indexOf('url');\n\t\t\t\t\t\t\t\t\t\tvar urlEnd = srcs[s].indexOf(')', urlStart);\n\t\t\t\t\t\t\t\t\t\tvar url = srcs[s].substr(urlStart + 5, urlEnd - urlStart - 6);\n\t\t\t\t\t\t\t\t\t\tvar doc = svg.parseXml(svg.ajax(url));\n\t\t\t\t\t\t\t\t\t\tvar fonts = doc.getElementsByTagName('font');\n\t\t\t\t\t\t\t\t\t\tfor (var f=0; f<fonts.length; f++) {\n\t\t\t\t\t\t\t\t\t\t\tvar font = svg.CreateElement(fonts[f]);\n\t\t\t\t\t\t\t\t\t\t\tsvg.Definitions[fontFamily] = font;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsvg.Element.style.prototype = new svg.Element.ElementBase;\n\t\t\n\t\t// use element \n\t\tsvg.Element.use = function(node) {\n\t\t\tthis.base = svg.Element.RenderedElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.baseSetContext = this.setContext;\n\t\t\tthis.setContext = function(ctx) {\n\t\t\t\tthis.baseSetContext(ctx);\n\t\t\t\tif (this.attribute('x').hasValue()) ctx.translate(this.attribute('x').Length.toPixels('x'), 0);\n\t\t\t\tif (this.attribute('y').hasValue()) ctx.translate(0, this.attribute('y').Length.toPixels('y'));\n\t\t\t}\n\t\t\t\n\t\t\tthis.getDefinition = function() {\n\t\t\t\tvar element = this.attribute('xlink:href').Definition.getDefinition();\n\t\t\t\tif (this.attribute('width').hasValue()) element.attribute('width', true).value = this.attribute('width').value;\n\t\t\t\tif (this.attribute('height').hasValue()) element.attribute('height', true).value = this.attribute('height').value;\n\t\t\t\treturn element;\n\t\t\t}\n\t\t\t\n\t\t\tthis.path = function(ctx) {\n\t\t\t\tvar element = this.getDefinition();\n\t\t\t\tif (element != null) element.path(ctx);\n\t\t\t}\n\t\t\t\n\t\t\tthis.renderChildren = function(ctx) {\n\t\t\t\tvar element = this.getDefinition();\n\t\t\t\tif (element != null) element.render(ctx);\n\t\t\t}\n\t\t}\n\t\tsvg.Element.use.prototype = new svg.Element.RenderedElementBase;\n\t\t\n\t\t// mask element\n\t\tsvg.Element.mask = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\n\t\t\t\t\t\t\n\t\t\tthis.apply = function(ctx, element) {\n\t\t\t\t// render as temp svg\t\n\t\t\t\tvar x = this.attribute('x').Length.toPixels('x');\n\t\t\t\tvar y = this.attribute('y').Length.toPixels('y');\n\t\t\t\tvar width = this.attribute('width').Length.toPixels('x');\n\t\t\t\tvar height = this.attribute('height').Length.toPixels('y');\n\t\t\t\t\n\t\t\t\t// temporarily remove mask to avoid recursion\n\t\t\t\tvar mask = element.attribute('mask').value;\n\t\t\t\telement.attribute('mask').value = '';\n\t\t\t\t\n\t\t\t\t\tvar cMask = document.createElement('canvas');\n\t\t\t\t\tcMask.width = x + width;\n\t\t\t\t\tcMask.height = y + height;\n\t\t\t\t\tvar maskCtx = cMask.getContext('2d');\n\t\t\t\t\tthis.renderChildren(maskCtx);\n\t\t\t\t\n\t\t\t\t\tvar c = document.createElement('canvas');\n\t\t\t\t\tc.width = x + width;\n\t\t\t\t\tc.height = y + height;\n\t\t\t\t\tvar tempCtx = c.getContext('2d');\n\t\t\t\t\telement.render(tempCtx);\n\t\t\t\t\ttempCtx.globalCompositeOperation = 'destination-in';\n\t\t\t\t\ttempCtx.fillStyle = maskCtx.createPattern(cMask, 'no-repeat');\n\t\t\t\t\ttempCtx.fillRect(0, 0, x + width, y + height);\n\t\t\t\t\t\n\t\t\t\t\tctx.fillStyle = tempCtx.createPattern(c, 'no-repeat');\n\t\t\t\t\tctx.fillRect(0, 0, x + width, y + height);\n\t\t\t\t\t\n\t\t\t\t// reassign mask\n\t\t\t\telement.attribute('mask').value = mask;\t\n\t\t\t}\n\t\t\t\n\t\t\tthis.render = function(ctx) {\n\t\t\t\t// NO RENDER\n\t\t\t}\n\t\t}\n\t\tsvg.Element.mask.prototype = new svg.Element.ElementBase;\n\t\t\n\t\t// clip element\n\t\tsvg.Element.clipPath = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\n\t\t\t\n\t\t\tthis.apply = function(ctx) {\n\t\t\t\tfor (var i=0; i<this.children.length; i++) {\n\t\t\t\t\tif (this.children[i].path) {\n\t\t\t\t\t\tthis.children[i].path(ctx);\n\t\t\t\t\t\tctx.clip();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.render = function(ctx) {\n\t\t\t\t// NO RENDER\n\t\t\t}\n\t\t}\n\t\tsvg.Element.clipPath.prototype = new svg.Element.ElementBase;\n\n\t\t// filters\n\t\tsvg.Element.filter = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\n\t\t\t\t\t\t\n\t\t\tthis.apply = function(ctx, element) {\n\t\t\t\t// render as temp svg\t\n\t\t\t\tvar bb = element.getBoundingBox();\n\t\t\t\tvar x = this.attribute('x').Length.toPixels('x');\n\t\t\t\tvar y = this.attribute('y').Length.toPixels('y');\n\t\t\t\tif (x == 0 || y == 0) {\n\t\t\t\t\tx = bb.x1;\n\t\t\t\t\ty = bb.y1;\n\t\t\t\t}\n\t\t\t\tvar width = this.attribute('width').Length.toPixels('x');\n\t\t\t\tvar height = this.attribute('height').Length.toPixels('y');\n\t\t\t\tif (width == 0 || height == 0) {\n\t\t\t\t\twidth = bb.width();\n\t\t\t\t\theight = bb.height();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// temporarily remove filter to avoid recursion\n\t\t\t\tvar filter = element.style('filter').value;\n\t\t\t\telement.style('filter').value = '';\n\t\t\t\t\n\t\t\t\t// max filter distance\n\t\t\t\tvar extraPercent = .20;\n\t\t\t\tvar px = extraPercent * width;\n\t\t\t\tvar py = extraPercent * height;\n\t\t\t\t\n\t\t\t\tvar c = document.createElement('canvas');\n\t\t\t\tc.width = width + 2*px;\n\t\t\t\tc.height = height + 2*py;\n\t\t\t\tvar tempCtx = c.getContext('2d');\n\t\t\t\ttempCtx.translate(-x + px, -y + py);\n\t\t\t\telement.render(tempCtx);\n\t\t\t\n\t\t\t\t// apply filters\n\t\t\t\tfor (var i=0; i<this.children.length; i++) {\n\t\t\t\t\tthis.children[i].apply(tempCtx, 0, 0, width + 2*px, height + 2*py);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// render on me\n\t\t\t\tctx.drawImage(c, 0, 0, width + 2*px, height + 2*py, x - px, y - py, width + 2*px, height + 2*py);\n\t\t\t\t\n\t\t\t\t// reassign filter\n\t\t\t\telement.style('filter', true).value = filter;\t\n\t\t\t}\n\t\t\t\n\t\t\tthis.render = function(ctx) {\n\t\t\t\t// NO RENDER\n\t\t\t}\t\t\n\t\t}\n\t\tsvg.Element.filter.prototype = new svg.Element.ElementBase;\n\t\t\n\t\tsvg.Element.feGaussianBlur = function(node) {\n\t\t\tthis.base = svg.Element.ElementBase;\n\t\t\tthis.base(node);\t\n\t\t\t\n\t\t\tfunction make_fgauss(sigma) {\n\t\t\t\tsigma = Math.max(sigma, 0.01);\t\t\t      \n\t\t\t\tvar len = Math.ceil(sigma * 4.0) + 1;                     \n\t\t\t\tmask = [];                               \n\t\t\t\tfor (var i = 0; i < len; i++) {                             \n\t\t\t\t\tmask[i] = Math.exp(-0.5 * (i / sigma) * (i / sigma));                                           \n\t\t\t\t}                                                           \n\t\t\t\treturn mask; \n\t\t\t}\n\t\t\t\n\t\t\tfunction normalize(mask) {\n\t\t\t\tvar sum = 0;\n\t\t\t\tfor (var i = 1; i < mask.length; i++) {\n\t\t\t\t\tsum += Math.abs(mask[i]);\n\t\t\t\t}\n\t\t\t\tsum = 2 * sum + Math.abs(mask[0]);\n\t\t\t\tfor (var i = 0; i < mask.length; i++) {\n\t\t\t\t\tmask[i] /= sum;\n\t\t\t\t}\n\t\t\t\treturn mask;\n\t\t\t}\n\t\t\t\n\t\t\tfunction convolve_even(src, dst, mask, width, height) {\n\t\t\t  for (var y = 0; y < height; y++) {\n\t\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\t  var a = imGet(src, x, y, width, height, 3)/255;\n\t\t\t\t  for (var rgba = 0; rgba < 4; rgba++) {\t\t\t\t\t  \n\t\t\t\t\t  var sum = mask[0] * (a==0?255:imGet(src, x, y, width, height, rgba)) * (a==0||rgba==3?1:a);\n\t\t\t\t\t  for (var i = 1; i < mask.length; i++) {\n\t\t\t\t\t\tvar a1 = imGet(src, Math.max(x-i,0), y, width, height, 3)/255;\n\t\t\t\t\t    var a2 = imGet(src, Math.min(x+i, width-1), y, width, height, 3)/255;\n\t\t\t\t\t\tsum += mask[i] * \n\t\t\t\t\t\t  ((a1==0?255:imGet(src, Math.max(x-i,0), y, width, height, rgba)) * (a1==0||rgba==3?1:a1) + \n\t\t\t\t\t\t   (a2==0?255:imGet(src, Math.min(x+i, width-1), y, width, height, rgba)) * (a2==0||rgba==3?1:a2));\n\t\t\t\t\t  }\n\t\t\t\t\t  imSet(dst, y, x, height, width, rgba, sum);\n\t\t\t\t  }\t\t\t  \n\t\t\t\t}\n\t\t\t  }\n\t\t\t}\t\t\n\n\t\t\tfunction imGet(img, x, y, width, height, rgba) {\n\t\t\t\treturn img[y*width*4 + x*4 + rgba];\n\t\t\t}\n\t\t\t\n\t\t\tfunction imSet(img, x, y, width, height, rgba, val) {\n\t\t\t\timg[y*width*4 + x*4 + rgba] = val;\n\t\t\t}\n\t\t\t\t\t\t\n\t\t\tfunction blur(ctx, width, height, sigma)\n\t\t\t{\n\t\t\t\tvar srcData = ctx.getImageData(0, 0, width, height);\n\t\t\t\tvar mask = make_fgauss(sigma);\n\t\t\t\tmask = normalize(mask);\n\t\t\t\ttmp = [];\n\t\t\t\tconvolve_even(srcData.data, tmp, mask, width, height);\n\t\t\t\tconvolve_even(tmp, srcData.data, mask, height, width);\n\t\t\t\tctx.clearRect(0, 0, width, height);\n\t\t\t\tctx.putImageData(srcData, 0, 0);\n\t\t\t}\t\t\t\n\t\t\n\t\t\tthis.apply = function(ctx, x, y, width, height) {\n\t\t\t\t// assuming x==0 && y==0 for now\n\t\t\t\tblur(ctx, width, height, this.attribute('stdDeviation').numValue());\n\t\t\t}\n\t\t}\n\t\tsvg.Element.filter.prototype = new svg.Element.feGaussianBlur;\n\t\t\n\t\t// title element, do nothing\n\t\tsvg.Element.title = function(node) {\n\t\t}\n\t\tsvg.Element.title.prototype = new svg.Element.ElementBase;\n\n\t\t// desc element, do nothing\n\t\tsvg.Element.desc = function(node) {\n\t\t}\n\t\tsvg.Element.desc.prototype = new svg.Element.ElementBase;\t\t\n\t\t\n\t\tsvg.Element.MISSING = function(node) {\n\t\t\tconsole.log('ERROR: Element \\'' + node.nodeName + '\\' not yet implemented.');\n\t\t}\n\t\tsvg.Element.MISSING.prototype = new svg.Element.ElementBase;\n\t\t\n\t\t// element factory\n\t\tsvg.CreateElement = function(node) {\t\n\t\t\tvar className = node.nodeName.replace(/^[^:]+:/,''); // remove namespace\n\t\t\tclassName = className.replace(/\\-/g,''); // remove dashes\n\t\t\tvar e = null;\n\t\t\tif (typeof(svg.Element[className]) != 'undefined') {\n\t\t\t\te = new svg.Element[className](node);\n\t\t\t}\n\t\t\telse {\n\t\t\t\te = new svg.Element.MISSING(node);\n\t\t\t}\n\n\t\t\te.type = node.nodeName;\n\t\t\treturn e;\n\t\t}\n\t\t\t\t\n\t\t// load from url\n\t\tsvg.load = function(ctx, url) {\n\t\t\tsvg.loadXml(ctx, svg.ajax(url));\n\t\t}\n\t\t\n\t\t// load from xml\n\t\tsvg.loadXml = function(ctx, xml) {\n\t\t\tsvg.loadXmlDoc(ctx, svg.parseXml(xml));\n\t\t}\n\t\t\n\t\tsvg.loadXmlDoc = function(ctx, dom) {\n\t\t\tsvg.init(ctx);\n\t\t\t\n\t\t\tvar mapXY = function(p) {\n\t\t\t\tvar e = ctx.canvas;\n\t\t\t\twhile (e) {\n\t\t\t\t\tp.x -= e.offsetLeft;\n\t\t\t\t\tp.y -= e.offsetTop;\n\t\t\t\t\te = e.offsetParent;\n\t\t\t\t}\n\t\t\t\tif (window.scrollX) p.x += window.scrollX;\n\t\t\t\tif (window.scrollY) p.y += window.scrollY;\n\t\t\t\treturn p;\n\t\t\t}\n\t\t\t\n\t\t\t// bind mouse\n\t\t\tif (svg.opts['ignoreMouse'] != true) {\n\t\t\t\tctx.canvas.onclick = function(e) {\n\t\t\t\t\tvar p = mapXY(new svg.Point(e != null ? e.clientX : event.clientX, e != null ? e.clientY : event.clientY));\n\t\t\t\t\tsvg.Mouse.onclick(p.x, p.y);\n\t\t\t\t};\n\t\t\t\tctx.canvas.onmousemove = function(e) {\n\t\t\t\t\tvar p = mapXY(new svg.Point(e != null ? e.clientX : event.clientX, e != null ? e.clientY : event.clientY));\n\t\t\t\t\tsvg.Mouse.onmousemove(p.x, p.y);\n\t\t\t\t};\n\t\t\t}\n\t\t\n\t\t\tvar e = svg.CreateElement(dom.documentElement);\n\t\t\te.root = true;\n\t\t\t\t\t\n\t\t\t// render loop\n\t\t\tvar isFirstRender = true;\n\t\t\tvar draw = function() {\n\t\t\t\tsvg.ViewPort.Clear();\n\t\t\t\tif (ctx.canvas.parentNode) svg.ViewPort.SetCurrent(ctx.canvas.parentNode.clientWidth, ctx.canvas.parentNode.clientHeight);\n\t\t\t\n\t\t\t\tif (svg.opts['ignoreDimensions'] != true) {\n\t\t\t\t\t// set canvas size\n\t\t\t\t\tif (e.style('width').hasValue()) {\n\t\t\t\t\t\tctx.canvas.width = e.style('width').Length.toPixels('x');\n\t\t\t\t\t\tctx.canvas.style.width = ctx.canvas.width + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tif (e.style('height').hasValue()) {\n\t\t\t\t\t\tctx.canvas.height = e.style('height').Length.toPixels('y');\n\t\t\t\t\t\tctx.canvas.style.height = ctx.canvas.height + 'px';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar cWidth = ctx.canvas.clientWidth || ctx.canvas.width;\n\t\t\t\tvar cHeight = ctx.canvas.clientHeight || ctx.canvas.height;\n\t\t\t\tsvg.ViewPort.SetCurrent(cWidth, cHeight);\t\t\n\t\t\t\t\n\t\t\t\tif (svg.opts != null && svg.opts['offsetX'] != null) e.attribute('x', true).value = svg.opts['offsetX'];\n\t\t\t\tif (svg.opts != null && svg.opts['offsetY'] != null) e.attribute('y', true).value = svg.opts['offsetY'];\n\t\t\t\tif (svg.opts != null && svg.opts['scaleWidth'] != null && svg.opts['scaleHeight'] != null) {\n\t\t\t\t\tvar xRatio = 1, yRatio = 1;\n\t\t\t\t\tif (e.attribute('width').hasValue()) xRatio = e.attribute('width').Length.toPixels('x') / svg.opts['scaleWidth'];\n\t\t\t\t\tif (e.attribute('height').hasValue()) yRatio = e.attribute('height').Length.toPixels('y') / svg.opts['scaleHeight'];\n\t\t\t\t\n\t\t\t\t\te.attribute('width', true).value = svg.opts['scaleWidth'];\n\t\t\t\t\te.attribute('height', true).value = svg.opts['scaleHeight'];\t\t\t\n\t\t\t\t\te.attribute('viewBox', true).value = '0 0 ' + (cWidth * xRatio) + ' ' + (cHeight * yRatio);\n\t\t\t\t\te.attribute('preserveAspectRatio', true).value = 'none';\n\t\t\t\t}\n\t\t\t\n\t\t\t\t// clear and render\n\t\t\t\tif (svg.opts['ignoreClear'] != true) {\n\t\t\t\t\tctx.clearRect(0, 0, cWidth, cHeight);\n\t\t\t\t}\n\t\t\t\te.render(ctx);\n\t\t\t\tif (isFirstRender) {\n\t\t\t\t\tisFirstRender = false;\n\t\t\t\t\tif (svg.opts != null && typeof(svg.opts['renderCallback']) == 'function') svg.opts['renderCallback']();\n\t\t\t\t}\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tvar waitingForImages = true;\n\t\t\tif (svg.ImagesLoaded()) {\n\t\t\t\twaitingForImages = false;\n\t\t\t\tdraw();\n\t\t\t}\n\t\t\tsvg.intervalID = setInterval(function() { \n\t\t\t\tvar needUpdate = false;\n\t\t\t\t\n\t\t\t\tif (waitingForImages && svg.ImagesLoaded()) {\n\t\t\t\t\twaitingForImages = false;\n\t\t\t\t\tneedUpdate = true;\n\t\t\t\t}\n\t\t\t\n\t\t\t\t// need update from mouse events?\n\t\t\t\tif (svg.opts['ignoreMouse'] != true) {\n\t\t\t\t\tneedUpdate = needUpdate | svg.Mouse.hasEvents();\n\t\t\t\t}\n\t\t\t\n\t\t\t\t// need update from animations?\n\t\t\t\tif (svg.opts['ignoreAnimation'] != true) {\n\t\t\t\t\tfor (var i=0; i<svg.Animations.length; i++) {\n\t\t\t\t\t\tneedUpdate = needUpdate | svg.Animations[i].update(1000 / svg.FRAMERATE);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// need update from redraw?\n\t\t\t\tif (svg.opts != null && typeof(svg.opts['forceRedraw']) == 'function') {\n\t\t\t\t\tif (svg.opts['forceRedraw']() == true) needUpdate = true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// render if needed\n\t\t\t\tif (needUpdate) {\n\t\t\t\t\tdraw();\t\t\t\t\n\t\t\t\t\tsvg.Mouse.runEvents(); // run and clear our events\n\t\t\t\t}\n\t\t\t}, 1000 / svg.FRAMERATE);\n\t\t}\n\t\t\n\t\tsvg.stop = function() {\n\t\t\tif (svg.intervalID) {\n\t\t\t\tclearInterval(svg.intervalID);\n\t\t\t}\n\t\t}\n\t\t\n\t\tsvg.Mouse = new (function() {\n\t\t\tthis.events = [];\n\t\t\tthis.hasEvents = function() { return this.events.length != 0; }\n\t\t\n\t\t\tthis.onclick = function(x, y) {\n\t\t\t\tthis.events.push({ type: 'onclick', x: x, y: y, \n\t\t\t\t\trun: function(e) { if (e.onclick) e.onclick(); }\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tthis.onmousemove = function(x, y) {\n\t\t\t\tthis.events.push({ type: 'onmousemove', x: x, y: y,\n\t\t\t\t\trun: function(e) { if (e.onmousemove) e.onmousemove(); }\n\t\t\t\t});\n\t\t\t}\t\t\t\n\t\t\t\n\t\t\tthis.eventElements = [];\n\t\t\t\n\t\t\tthis.checkPath = function(element, ctx) {\n\t\t\t\tfor (var i=0; i<this.events.length; i++) {\n\t\t\t\t\tvar e = this.events[i];\n\t\t\t\t\tif (ctx.isPointInPath && ctx.isPointInPath(e.x, e.y)) this.eventElements[i] = element;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.checkBoundingBox = function(element, bb) {\n\t\t\t\tfor (var i=0; i<this.events.length; i++) {\n\t\t\t\t\tvar e = this.events[i];\n\t\t\t\t\tif (bb.isPointInBox(e.x, e.y)) this.eventElements[i] = element;\n\t\t\t\t}\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tthis.runEvents = function() {\n\t\t\t\tsvg.ctx.canvas.style.cursor = '';\n\t\t\t\t\n\t\t\t\tfor (var i=0; i<this.events.length; i++) {\n\t\t\t\t\tvar e = this.events[i];\n\t\t\t\t\tvar element = this.eventElements[i];\n\t\t\t\t\twhile (element) {\n\t\t\t\t\t\te.run(element);\n\t\t\t\t\t\telement = element.parent;\n\t\t\t\t\t}\n\t\t\t\t}\t\t\n\t\t\t\n\t\t\t\t// done running, clear\n\t\t\t\tthis.events = []; \n\t\t\t\tthis.eventElements = [];\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn svg;\n\t}\n})();\n\nif (CanvasRenderingContext2D) {\n\tCanvasRenderingContext2D.prototype.drawSvg = function(s, dx, dy, dw, dh) {\n\t\tcanvg(this.canvas, s, { \n\t\t\tignoreMouse: true, \n\t\t\tignoreAnimation: true, \n\t\t\tignoreDimensions: true, \n\t\t\tignoreClear: true, \n\t\t\toffsetX: dx, \n\t\t\toffsetY: dy, \n\t\t\tscaleWidth: dw, \n\t\t\tscaleHeight: dh\n\t\t});\n\t}\n}/**\n * @license Highcharts JS v3.0.6 (2013-10-04)\n * CanVGRenderer Extension module\n *\n * (c) 2011-2012 Torstein Hnsi, Erik Olsson\n *\n * License: www.highcharts.com/license\n */\n\n// JSLint options:\n/*global Highcharts */\n\n(function (Highcharts) { // encapsulate\n\tvar UNDEFINED,\n\t\tDIV = 'div',\n\t\tABSOLUTE = 'absolute',\n\t\tRELATIVE = 'relative',\n\t\tHIDDEN = 'hidden',\n\t\tVISIBLE = 'visible',\n\t\tPX = 'px',\n\t\tcss = Highcharts.css,\n\t\tCanVGRenderer = Highcharts.CanVGRenderer,\n\t\tSVGRenderer = Highcharts.SVGRenderer,\n\t\textend = Highcharts.extend,\n\t\tmerge = Highcharts.merge,\n\t\taddEvent = Highcharts.addEvent,\n\t\tcreateElement = Highcharts.createElement,\n\t\tdiscardElement = Highcharts.discardElement;\n\n\t// Extend CanVG renderer on demand, inherit from SVGRenderer\n\textend(CanVGRenderer.prototype, SVGRenderer.prototype);\n\n\t// Add additional functionality:\n\textend(CanVGRenderer.prototype, {\n\t\tcreate: function (chart, container, chartWidth, chartHeight) {\n\t\t\tthis.setContainer(container, chartWidth, chartHeight);\n\t\t\tthis.configure(chart);\n\t\t},\n\t\tsetContainer: function (container, chartWidth, chartHeight) {\n\t\t\tvar containerStyle = container.style,\n\t\t\t\tcontainerParent = container.parentNode,\n\t\t\t\tcontainerLeft = containerStyle.left,\n\t\t\t\tcontainerTop = containerStyle.top,\n\t\t\t\tcontainerOffsetWidth = container.offsetWidth,\n\t\t\t\tcontainerOffsetHeight = container.offsetHeight,\n\t\t\t\tcanvas,\n\t\t\t\tinitialHiddenStyle = { visibility: HIDDEN, position: ABSOLUTE };\n\n\t\t\tthis.init.apply(this, [container, chartWidth, chartHeight]);\n\n\t\t\t// add the canvas above it\n\t\t\tcanvas = createElement('canvas', {\n\t\t\t\twidth: containerOffsetWidth,\n\t\t\t\theight: containerOffsetHeight\n\t\t\t}, {\n\t\t\t\tposition: RELATIVE,\n\t\t\t\tleft: containerLeft,\n\t\t\t\ttop: containerTop\n\t\t\t}, container);\n\t\t\tthis.canvas = canvas;\n\n\t\t\t// Create the tooltip line and div, they are placed as siblings to\n\t\t\t// the container (and as direct childs to the div specified in the html page)\n\t\t\tthis.ttLine = createElement(DIV, null, initialHiddenStyle, containerParent);\n\t\t\tthis.ttDiv = createElement(DIV, null, initialHiddenStyle, containerParent);\n\t\t\tthis.ttTimer = UNDEFINED;\n\n\t\t\t// Move away the svg node to a new div inside the container's parent so we can hide it.\n\t\t\tvar hiddenSvg = createElement(DIV, {\n\t\t\t\twidth: containerOffsetWidth,\n\t\t\t\theight: containerOffsetHeight\n\t\t\t}, {\n\t\t\t\tvisibility: HIDDEN,\n\t\t\t\tleft: containerLeft,\n\t\t\t\ttop: containerTop\n\t\t\t}, containerParent);\n\t\t\tthis.hiddenSvg = hiddenSvg;\n\t\t\thiddenSvg.appendChild(this.box);\n\t\t},\n\n\t\t/**\n\t\t * Configures the renderer with the chart. Attach a listener to the event tooltipRefresh.\n\t\t **/\n\t\tconfigure: function (chart) {\n\t\t\tvar renderer = this,\n\t\t\t\toptions = chart.options.tooltip,\n\t\t\t\tborderWidth = options.borderWidth,\n\t\t\t\ttooltipDiv = renderer.ttDiv,\n\t\t\t\ttooltipDivStyle = options.style,\n\t\t\t\ttooltipLine = renderer.ttLine,\n\t\t\t\tpadding = parseInt(tooltipDivStyle.padding, 10);\n\n\t\t\t// Add border styling from options to the style\n\t\t\ttooltipDivStyle = merge(tooltipDivStyle, {\n\t\t\t\tpadding: padding + PX,\n\t\t\t\t'background-color': options.backgroundColor,\n\t\t\t\t'border-style': 'solid',\n\t\t\t\t'border-width': borderWidth + PX,\n\t\t\t\t'border-radius': options.borderRadius + PX\n\t\t\t});\n\n\t\t\t// Optionally add shadow\n\t\t\tif (options.shadow) {\n\t\t\t\ttooltipDivStyle = merge(tooltipDivStyle, {\n\t\t\t\t\t'box-shadow': '1px 1px 3px gray', // w3c\n\t\t\t\t\t'-webkit-box-shadow': '1px 1px 3px gray' // webkit\n\t\t\t\t});\n\t\t\t}\n\t\t\tcss(tooltipDiv, tooltipDivStyle);\n\n\t\t\t// Set simple style on the line\n\t\t\tcss(tooltipLine, {\n\t\t\t\t'border-left': '1px solid darkgray'\n\t\t\t});\n\n\t\t\t// This event is triggered when a new tooltip should be shown\n\t\t\taddEvent(chart, 'tooltipRefresh', function (args) {\n\t\t\t\tvar chartContainer = chart.container,\n\t\t\t\t\toffsetLeft = chartContainer.offsetLeft,\n\t\t\t\t\toffsetTop = chartContainer.offsetTop,\n\t\t\t\t\tposition;\n\n\t\t\t\t// Set the content of the tooltip\n\t\t\t\ttooltipDiv.innerHTML = args.text;\n\n\t\t\t\t// Compute the best position for the tooltip based on the divs size and container size.\n\t\t\t\tposition = chart.tooltip.getPosition(tooltipDiv.offsetWidth, tooltipDiv.offsetHeight, {plotX: args.x, plotY: args.y});\n\n\t\t\t\tcss(tooltipDiv, {\n\t\t\t\t\tvisibility: VISIBLE,\n\t\t\t\t\tleft: position.x + PX,\n\t\t\t\t\ttop: position.y + PX,\n\t\t\t\t\t'border-color': args.borderColor\n\t\t\t\t});\n\n\t\t\t\t// Position the tooltip line\n\t\t\t\tcss(tooltipLine, {\n\t\t\t\t\tvisibility: VISIBLE,\n\t\t\t\t\tleft: offsetLeft + args.x + PX,\n\t\t\t\t\ttop: offsetTop + chart.plotTop + PX,\n\t\t\t\t\theight: chart.plotHeight  + PX\n\t\t\t\t});\n\n\t\t\t\t// This timeout hides the tooltip after 3 seconds\n\t\t\t\t// First clear any existing timer\n\t\t\t\tif (renderer.ttTimer !== UNDEFINED) {\n\t\t\t\t\tclearTimeout(renderer.ttTimer);\n\t\t\t\t}\n\n\t\t\t\t// Start a new timer that hides tooltip and line\n\t\t\t\trenderer.ttTimer = setTimeout(function () {\n\t\t\t\t\tcss(tooltipDiv, { visibility: HIDDEN });\n\t\t\t\t\tcss(tooltipLine, { visibility: HIDDEN });\n\t\t\t\t}, 3000);\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Extend SVGRenderer.destroy to also destroy the elements added by CanVGRenderer.\n\t\t */\n\t\tdestroy: function () {\n\t\t\tvar renderer = this;\n\n\t\t\t// Remove the canvas\n\t\t\tdiscardElement(renderer.canvas);\n\n\t\t\t// Kill the timer\n\t\t\tif (renderer.ttTimer !== UNDEFINED) {\n\t\t\t\tclearTimeout(renderer.ttTimer);\n\t\t\t}\n\n\t\t\t// Remove the divs for tooltip and line\n\t\t\tdiscardElement(renderer.ttLine);\n\t\t\tdiscardElement(renderer.ttDiv);\n\t\t\tdiscardElement(renderer.hiddenSvg);\n\n\t\t\t// Continue with base class\n\t\t\treturn SVGRenderer.prototype.destroy.apply(renderer);\n\t\t},\n\n\t\t/**\n\t\t * Take a color and return it if it's a string, do not make it a gradient even if it is a\n\t\t * gradient. Currently canvg cannot render gradients (turns out black),\n\t\t * see: http://code.google.com/p/canvg/issues/detail?id=104\n\t\t *\n\t\t * @param {Object} color The color or config object\n\t\t */\n\t\tcolor: function (color, elem, prop) {\n\t\t\tif (color && color.linearGradient) {\n\t\t\t\t// Pick the end color and forward to base implementation\n\t\t\t\tcolor = color.stops[color.stops.length - 1][1];\n\t\t\t}\n\t\t\treturn SVGRenderer.prototype.color.call(this, color, elem, prop);\n\t\t},\n\n\t\t/**\n\t\t * Draws the SVG on the canvas or adds a draw invokation to the deferred list.\n\t\t */\n\t\tdraw: function () {\n\t\t\tvar renderer = this;\n\t\t\twindow.canvg(renderer.canvas, renderer.hiddenSvg.innerHTML);\n\t\t}\n\t});\n}(Highcharts));\n"]}